<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN' 'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
<title>doc/html/dropout_8h_source.html</title>
<meta name='robots' content='noindex,nofollow' />
<meta name='generator' content='GLOBAL-6.6.4' />
<meta http-equiv='Content-Style-Type' content='text/css' />
<link rel='stylesheet' type='text/css' href='../style.css' />
</head>
<body>
<!-- beginning of fixed guide -->
<div id='guide'><ul>
<li><a href='#TOP'><img class='icon' src='../icons/first.png' alt='[^]' /></a></li>
<li><a href='#BOTTOM'><img class='icon' src='../icons/last.png' alt='[v]' /></a></li>
<li><a href='#TOP'><img class='icon' src='../icons/top.png' alt='[top]' /></a></li>
<li><a href='#BOTTOM'><img class='icon' src='../icons/bottom.png' alt='[bottom]' /></a></li>
<li><a href='../mains.html'><img class='icon' src='../icons/index.png' alt='[index]' /></a></li>
<li><a href='../help.html'><img class='icon' src='../icons/help.png' alt='[help]' /></a></li>
<li class='standout'><span><a href='../files/484.html'>doc</a>/<a href='../files/485.html'>html</a>/dropout_8h_source.html</span></li>
</ul></div>
<!-- end of fixed guide -->
<a id='TOP' name='TOP'></a><h2 class='header'><a href='../mains.html'>root</a>/<a href='../files/484.html'>doc</a>/<a href='../files/485.html'>html</a>/dropout_8h_source.html</h2>
<em class='comment'>/* <img class='icon' src='../icons/n_left.png' alt='[previous]' /><img class='icon' src='../icons/n_right.png' alt='[next]' /><img class='icon' src='../icons/n_first.png' alt='[first]' /><img class='icon' src='../icons/n_last.png' alt='[last]' /><img class='icon' src='../icons/n_top.png' alt='[top]' /><a href='#BOTTOM'><img class='icon' src='../icons/bottom.png' alt='[bottom]' /></a><a href='../mains.html'><img class='icon' src='../icons/index.png' alt='[index]' /></a><a href='../help.html'><img class='icon' src='../icons/help.png' alt='[help]' /></a>&nbsp;<input type='text' readonly onfocus='this.select();' value='+1 doc/html/dropout_8h_source.html'  /> */</em>
<hr />
<pre>
<a id='L1' name='L1'></a>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;
<a id='L2' name='L2'></a>&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
<a id='L3' name='L3'></a>&lt;head&gt;
<a id='L4' name='L4'></a>&lt;meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/&gt;
<a id='L5' name='L5'></a>&lt;meta http-equiv="X-UA-Compatible" content="IE=9"/&gt;
<a id='L6' name='L6'></a>&lt;meta name="generator" content="Doxygen 1.8.13"/&gt;
<a id='L7' name='L7'></a>&lt;meta name="viewport" content="width=device-width, initial-scale=1"/&gt;
<a id='L8' name='L8'></a>&lt;title&gt;vgg: /home/tau/public_html/lecture/parallel_distributed/2018/handson/tau/parallel-distributed-handson/20vgg/include/dropout.h Source File&lt;/title&gt;
<a id='L9' name='L9'></a>&lt;link href="tabs.css" rel="stylesheet" type="text/css"/&gt;
<a id='L10' name='L10'></a>&lt;script type="text/javascript" src="jquery.js"&gt;&lt;/script&gt;
<a id='L11' name='L11'></a>&lt;script type="text/javascript" src="dynsections.js"&gt;&lt;/script&gt;
<a id='L12' name='L12'></a>&lt;link href="search/search.css" rel="stylesheet" type="text/css"/&gt;
<a id='L13' name='L13'></a>&lt;script type="text/javascript" src="search/searchdata.js"&gt;&lt;/script&gt;
<a id='L14' name='L14'></a>&lt;script type="text/javascript" src="search/search.js"&gt;&lt;/script&gt;
<a id='L15' name='L15'></a>&lt;link href="doxygen.css" rel="stylesheet" type="text/css" /&gt;
<a id='L16' name='L16'></a>&lt;/head&gt;
<a id='L17' name='L17'></a>&lt;body&gt;
<a id='L18' name='L18'></a>&lt;div id="top"&gt;&lt;!-- do not remove this div, it is closed by doxygen! --&gt;
<a id='L19' name='L19'></a>&lt;div id="titlearea"&gt;
<a id='L20' name='L20'></a>&lt;table cellspacing="0" cellpadding="0"&gt;
<a id='L21' name='L21'></a> &lt;tbody&gt;
<a id='L22' name='L22'></a> &lt;tr style="height: 56px;"&gt;
<a id='L23' name='L23'></a>  &lt;td id="projectalign" style="padding-left: 0.5em;"&gt;
<a id='L24' name='L24'></a>   &lt;div id="projectname"&gt;vgg
<a id='L25' name='L25'></a>   &lt;/div&gt;
<a id='L26' name='L26'></a>  &lt;/td&gt;
<a id='L27' name='L27'></a> &lt;/tr&gt;
<a id='L28' name='L28'></a> &lt;/tbody&gt;
<a id='L29' name='L29'></a>&lt;/table&gt;
<a id='L30' name='L30'></a>&lt;/div&gt;
<a id='L31' name='L31'></a>&lt;!-- end header part --&gt;
<a id='L32' name='L32'></a>&lt;!-- Generated by Doxygen 1.8.13 --&gt;
<a id='L33' name='L33'></a>&lt;script type="text/javascript"&gt;
<a id='L34' name='L34'></a>var searchBox = new SearchBox("searchBox", "search",false,'Search');
<a id='L35' name='L35'></a>&lt;/script&gt;
<a id='L36' name='L36'></a>&lt;script type="text/javascript" src="menudata.js"&gt;&lt;/script&gt;
<a id='L37' name='L37'></a>&lt;script type="text/javascript" src="menu.js"&gt;&lt;/script&gt;
<a id='L38' name='L38'></a>&lt;script type="text/javascript"&gt;
<a id='L39' name='L39'></a>$(function() {
<a id='L40' name='L40'></a>  initMenu('',true,false,'search.php','Search');
<a id='L41' name='L41'></a>  $(document).ready(function() { init_search(); });
<a id='L42' name='L42'></a>});
<a id='L43' name='L43'></a>&lt;/script&gt;
<a id='L44' name='L44'></a>&lt;div id="main-nav"&gt;&lt;/div&gt;
<a id='L45' name='L45'></a>&lt;!-- window showing the filter options --&gt;
<a id='L46' name='L46'></a>&lt;div id="MSearchSelectWindow"
<a id='L47' name='L47'></a>     onmouseover="return searchBox.OnSearchSelectShow()"
<a id='L48' name='L48'></a>     onmouseout="return searchBox.OnSearchSelectHide()"
<a id='L49' name='L49'></a>     onkeydown="return searchBox.OnSearchSelectKey(event)"&gt;
<a id='L50' name='L50'></a>&lt;/div&gt;
<a id='L51' name='L51'></a>
<a id='L52' name='L52'></a>&lt;!-- iframe showing the search results (closed by default) --&gt;
<a id='L53' name='L53'></a>&lt;div id="MSearchResultsWindow"&gt;
<a id='L54' name='L54'></a>&lt;iframe src="javascript:void(0)" frameborder="0" 
<a id='L55' name='L55'></a>        name="MSearchResults" id="MSearchResults"&gt;
<a id='L56' name='L56'></a>&lt;/iframe&gt;
<a id='L57' name='L57'></a>&lt;/div&gt;
<a id='L58' name='L58'></a>
<a id='L59' name='L59'></a>&lt;div id="nav-path" class="navpath"&gt;
<a id='L60' name='L60'></a>  &lt;ul&gt;
<a id='L61' name='L61'></a>&lt;li class="navelem"&gt;&lt;a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html"&gt;include&lt;/a&gt;&lt;/li&gt;  &lt;/ul&gt;
<a id='L62' name='L62'></a>&lt;/div&gt;
<a id='L63' name='L63'></a>&lt;/div&gt;&lt;!-- top --&gt;
<a id='L64' name='L64'></a>&lt;div class="header"&gt;
<a id='L65' name='L65'></a>  &lt;div class="headertitle"&gt;
<a id='L66' name='L66'></a>&lt;div class="title"&gt;dropout.h&lt;/div&gt;  &lt;/div&gt;
<a id='L67' name='L67'></a>&lt;/div&gt;&lt;!--header--&gt;
<a id='L68' name='L68'></a>&lt;div class="contents"&gt;
<a id='L69' name='L69'></a>&lt;a href="dropout_8h.html"&gt;Go to the documentation of this file.&lt;/a&gt;&lt;div class="fragment"&gt;&lt;div class="line"&gt;&lt;a name="l00001"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;    1&lt;/span&gt;&amp;#160;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00005"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;    5&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#pragma once&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00006"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;    6&lt;/span&gt;&amp;#160;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00007"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;    7&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#include &amp;quot;&lt;a class="code" href="vgg__util_8h.html"&gt;vgg_util.h&lt;/a&gt;&amp;quot;&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00008"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;    8&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#include &amp;quot;&lt;a class="code" href="vgg__arrays_8h.html"&gt;vgg_arrays.h&lt;/a&gt;&amp;quot;&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00009"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;    9&lt;/span&gt;&amp;#160;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00010"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;   10&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#if __NVCC__&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00011"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;   11&lt;/span&gt;&amp;#160;&lt;span class="keyword"&gt;template&lt;/span&gt;&amp;lt;&lt;span class="keywordtype"&gt;id&lt;/span&gt;x_t maxB,&lt;span class="keywordtype"&gt;id&lt;/span&gt;x_t C,&lt;span class="keywordtype"&gt;id&lt;/span&gt;x_t H,&lt;span class="keywordtype"&gt;id&lt;/span&gt;x_t W&amp;gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00012"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="structDropout.html"&gt;   12&lt;/a&gt;&lt;/span&gt;&amp;#160;  &lt;span class="keyword"&gt;struct &lt;/span&gt;&lt;a class="code" href="structDropout.html"&gt;Dropout&lt;/a&gt;;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00013"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;   13&lt;/span&gt;&amp;#160;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00022"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;   22&lt;/span&gt;&amp;#160;&lt;span class="keyword"&gt;template&lt;/span&gt;&amp;lt;&lt;span class="keywordtype"&gt;id&lt;/span&gt;x_t maxB,&lt;span class="keywordtype"&gt;id&lt;/span&gt;x_t C,&lt;span class="keywordtype"&gt;id&lt;/span&gt;x_t H,&lt;span class="keywordtype"&gt;id&lt;/span&gt;x_t W&amp;gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00023"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="dropout_8h.html#a481b6aac35e6819a36e87b00866a2cf8"&gt;   23&lt;/a&gt;&lt;/span&gt;&amp;#160;  __global__ &lt;span class="keywordtype"&gt;void&lt;/span&gt; &lt;a class="code" href="dropout_8h.html#a481b6aac35e6819a36e87b00866a2cf8"&gt;forward_global&lt;/a&gt;(&lt;a class="code" href="structDropout.html"&gt;Dropout&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;* &lt;a class="code" href="structDropout.html#a2ce2e6920dfb911f679af91ff9b6de55"&gt;dev&lt;/a&gt;,&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00024"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;   24&lt;/span&gt;&amp;#160;                               &lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;* x_dev) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00025"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;   25&lt;/span&gt;&amp;#160;  dev-&amp;gt;&lt;a class="code" href="structDropout.html#a81ee0268c4195380873af8ced5b1acc7"&gt;forward_dev&lt;/a&gt;(*x_dev);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00026"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;   26&lt;/span&gt;&amp;#160;}&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00027"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;   27&lt;/span&gt;&amp;#160;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00036"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;   36&lt;/span&gt;&amp;#160;&lt;span class="keyword"&gt;template&lt;/span&gt;&amp;lt;&lt;span class="keywordtype"&gt;id&lt;/span&gt;x_t maxB,&lt;span class="keywordtype"&gt;id&lt;/span&gt;x_t C,&lt;span class="keywordtype"&gt;id&lt;/span&gt;x_t H,&lt;span class="keywordtype"&gt;id&lt;/span&gt;x_t W&amp;gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00037"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="dropout_8h.html#a1eba1ae8b54b7b1ac7da64793993f58a"&gt;   37&lt;/a&gt;&lt;/span&gt;&amp;#160;  __global__ &lt;span class="keywordtype"&gt;void&lt;/span&gt; &lt;a class="code" href="dropout_8h.html#a1eba1ae8b54b7b1ac7da64793993f58a"&gt;backward_global&lt;/a&gt;(&lt;a class="code" href="structDropout.html"&gt;Dropout&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;* &lt;a class="code" href="structDropout.html#a2ce2e6920dfb911f679af91ff9b6de55"&gt;dev&lt;/a&gt;,&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00038"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;   38&lt;/span&gt;&amp;#160;                                &lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;* gy_dev) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00039"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;   39&lt;/span&gt;&amp;#160;  dev-&amp;gt;&lt;a class="code" href="structDropout.html#a5bbc54ad4125bf6768b5eeb17802a468"&gt;backward_dev&lt;/a&gt;(*gy_dev);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00040"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;   40&lt;/span&gt;&amp;#160;}&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00041"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;   41&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#endif&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00042"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;   42&lt;/span&gt;&amp;#160;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00059"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;   59&lt;/span&gt;&amp;#160;&lt;span class="keyword"&gt;template&lt;/span&gt;&amp;lt;&lt;span class="keywordtype"&gt;id&lt;/span&gt;x_t maxB,&lt;span class="keywordtype"&gt;id&lt;/span&gt;x_t C,&lt;span class="keywordtype"&gt;id&lt;/span&gt;x_t H,&lt;span class="keywordtype"&gt;id&lt;/span&gt;x_t W&amp;gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00060"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;   60&lt;/span&gt;&amp;#160;&lt;span class="keyword"&gt;struct &lt;/span&gt;&lt;a class="code" href="structDropout.html"&gt;Dropout&lt;/a&gt; {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00061"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;   61&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#if __NVCC__&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00062"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="structDropout.html#a2ce2e6920dfb911f679af91ff9b6de55"&gt;   62&lt;/a&gt;&lt;/span&gt;&amp;#160;  &lt;a class="code" href="structDropout.html"&gt;Dropout&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;* &lt;a class="code" href="structDropout.html#a2ce2e6920dfb911f679af91ff9b6de55"&gt;dev&lt;/a&gt;;     &lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00063"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;   63&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#endif&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00064"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="structDropout.html#a3d9589e177c7fd00af8d7e82db651e48"&gt;   64&lt;/a&gt;&lt;/span&gt;&amp;#160;  &lt;a class="code" href="structcmdline__opt.html"&gt;cmdline_opt&lt;/a&gt; &lt;a class="code" href="structDropout.html#a3d9589e177c7fd00af8d7e82db651e48"&gt;opt&lt;/a&gt;;              &lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00065"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="structDropout.html#a55a275be949499a6f3f27fcb9989964e"&gt;   65&lt;/a&gt;&lt;/span&gt;&amp;#160;  &lt;a class="code" href="structlogger.html"&gt;logger&lt;/a&gt; * &lt;a class="code" href="structDropout.html#a55a275be949499a6f3f27fcb9989964e"&gt;lgr&lt;/a&gt;;                 &lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00066"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="structDropout.html#a176eb537c9aef161087863244f1e637f"&gt;   66&lt;/a&gt;&lt;/span&gt;&amp;#160;  &lt;a class="code" href="structrnd__gen__t.html"&gt;rnd_gen_t&lt;/a&gt; &lt;a class="code" href="structDropout.html#a176eb537c9aef161087863244f1e637f"&gt;rg&lt;/a&gt;;                 &lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00067"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="structDropout.html#ad758df2bfbd791e6b25e29c8204e0df4"&gt;   67&lt;/a&gt;&lt;/span&gt;&amp;#160;  &lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt; &lt;a class="code" href="structDropout.html#ad758df2bfbd791e6b25e29c8204e0df4"&gt;y&lt;/a&gt;;         &lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00068"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="structDropout.html#a1cf5aced88d251c6b49772ad318bbd27"&gt;   68&lt;/a&gt;&lt;/span&gt;&amp;#160;  &lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt; &lt;a class="code" href="structDropout.html#a1cf5aced88d251c6b49772ad318bbd27"&gt;gx&lt;/a&gt;;        &lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00069"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="structDropout.html#a4181a1bcb986c62b1c6a82a3c1e03d9f"&gt;   69&lt;/a&gt;&lt;/span&gt;&amp;#160;  &lt;a class="code" href="vgg__util_8h.html#a1082d08aaa761215ec83e7149f27ad16"&gt;real&lt;/a&gt; &lt;a class="code" href="structDropout.html#a4181a1bcb986c62b1c6a82a3c1e03d9f"&gt;drop_ratio&lt;/a&gt;;              &lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00070"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="structDropout.html#ac409c1b3a996e35eb78964aa52c5a203"&gt;   70&lt;/a&gt;&lt;/span&gt;&amp;#160;  &lt;span class="keywordtype"&gt;long&lt;/span&gt; &lt;a class="code" href="structDropout.html#ac409c1b3a996e35eb78964aa52c5a203"&gt;state_forward&lt;/a&gt;;           &lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00079"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="structDropout.html#ab684bc3308abad8598f76bdaaa2598ee"&gt;   79&lt;/a&gt;&lt;/span&gt;&amp;#160;  &lt;span class="keywordtype"&gt;void&lt;/span&gt; &lt;a class="code" href="structDropout.html#ab684bc3308abad8598f76bdaaa2598ee"&gt;init&lt;/a&gt;(&lt;a class="code" href="structcmdline__opt.html"&gt;cmdline_opt&lt;/a&gt; opt, &lt;a class="code" href="structlogger.html"&gt;logger&lt;/a&gt; * lgr, &lt;a class="code" href="vgg__util_8h.html#a1082d08aaa761215ec83e7149f27ad16"&gt;real&lt;/a&gt; drop_ratio, &lt;span class="keywordtype"&gt;long&lt;/span&gt; drop_seed) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00080"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;   80&lt;/span&gt;&amp;#160;    this-&amp;gt;opt = &lt;a class="code" href="structDropout.html#a3d9589e177c7fd00af8d7e82db651e48"&gt;opt&lt;/a&gt;;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00081"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;   81&lt;/span&gt;&amp;#160;    this-&amp;gt;lgr = &lt;a class="code" href="structDropout.html#a55a275be949499a6f3f27fcb9989964e"&gt;lgr&lt;/a&gt;;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00082"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;   82&lt;/span&gt;&amp;#160;    this-&amp;gt;drop_ratio = &lt;a class="code" href="structDropout.html#a4181a1bcb986c62b1c6a82a3c1e03d9f"&gt;drop_ratio&lt;/a&gt;;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00083"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;   83&lt;/span&gt;&amp;#160;    rg.&lt;a class="code" href="structrnd__gen__t.html#a0e43f9b2d156cb2535bfa1a88cd9eb25"&gt;seed&lt;/a&gt;(drop_seed);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00084"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;   84&lt;/span&gt;&amp;#160;  }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00090"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="structDropout.html#a364b0df75c98d5b73fd11a77bf11bf89"&gt;   90&lt;/a&gt;&lt;/span&gt;&amp;#160;  &lt;a class="code" href="structDropout.html"&gt;Dropout&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;* &lt;a class="code" href="structDropout.html#a364b0df75c98d5b73fd11a77bf11bf89"&gt;copy&lt;/a&gt;() {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00091"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;   91&lt;/span&gt;&amp;#160;    &lt;a class="code" href="structDropout.html"&gt;Dropout&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;* c = &lt;span class="keyword"&gt;new&lt;/span&gt; &lt;a class="code" href="structDropout.html"&gt;Dropout&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;(*this);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00092"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;   92&lt;/span&gt;&amp;#160;    c-&amp;gt;&lt;a class="code" href="structDropout.html#ad1ea86b3d3240a95c9b8c52756ef23a9"&gt;make_dev&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00093"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;   93&lt;/span&gt;&amp;#160;    &lt;span class="keywordflow"&gt;return&lt;/span&gt; c;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00094"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;   94&lt;/span&gt;&amp;#160;  }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00104"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="structDropout.html#aacd2c2da4fb3bd6718b2b43bc26538b9"&gt;  104&lt;/a&gt;&lt;/span&gt;&amp;#160;  &lt;span class="keywordtype"&gt;void&lt;/span&gt; &lt;a class="code" href="structDropout.html#aacd2c2da4fb3bd6718b2b43bc26538b9"&gt;set_dev&lt;/a&gt;(&lt;a class="code" href="structDropout.html"&gt;Dropout&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;* dev) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00105"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  105&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#if __NVCC__&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00106"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  106&lt;/span&gt;&amp;#160;    this-&amp;gt;dev = &lt;a class="code" href="structDropout.html#a2ce2e6920dfb911f679af91ff9b6de55"&gt;dev&lt;/a&gt;;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00107"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  107&lt;/span&gt;&amp;#160;    y.&lt;a class="code" href="structarray4.html#acd8ae42dbddd396fb1a88debdd1bf8e7"&gt;set_dev&lt;/a&gt;(dev ? &amp;amp;dev-&amp;gt;&lt;a class="code" href="structDropout.html#ad758df2bfbd791e6b25e29c8204e0df4"&gt;y&lt;/a&gt; : 0);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00108"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  108&lt;/span&gt;&amp;#160;    gx.&lt;a class="code" href="structarray4.html#acd8ae42dbddd396fb1a88debdd1bf8e7"&gt;set_dev&lt;/a&gt;(dev ? &amp;amp;dev-&amp;gt;&lt;a class="code" href="structDropout.html#a1cf5aced88d251c6b49772ad318bbd27"&gt;gx&lt;/a&gt; : 0);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00109"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  109&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#endif&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00110"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  110&lt;/span&gt;&amp;#160;  }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00118"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="structDropout.html#ad1ea86b3d3240a95c9b8c52756ef23a9"&gt;  118&lt;/a&gt;&lt;/span&gt;&amp;#160;  &lt;span class="keywordtype"&gt;void&lt;/span&gt; &lt;a class="code" href="structDropout.html#ad1ea86b3d3240a95c9b8c52756ef23a9"&gt;make_dev&lt;/a&gt;() {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00119"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  119&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#if __NVCC__&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00120"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  120&lt;/span&gt;&amp;#160;    &lt;span class="keywordflow"&gt;if&lt;/span&gt; (opt.&lt;a class="code" href="structcmdline__opt.html#acb8b225214983d009415a26f2e45eb65"&gt;gpu_algo&lt;/a&gt;) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00121"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  121&lt;/span&gt;&amp;#160;      dev = (&lt;a class="code" href="structDropout.html"&gt;Dropout&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;*)&lt;a class="code" href="cuda__util_8h.html#afefb7dee05552efd8d1e91a09c90dc79"&gt;dev_malloc&lt;/a&gt;(&lt;span class="keyword"&gt;sizeof&lt;/span&gt;(*&lt;span class="keyword"&gt;this&lt;/span&gt;));&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00122"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  122&lt;/span&gt;&amp;#160;    } &lt;span class="keywordflow"&gt;else&lt;/span&gt; {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00123"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  123&lt;/span&gt;&amp;#160;      dev = 0;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00124"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  124&lt;/span&gt;&amp;#160;    }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00125"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  125&lt;/span&gt;&amp;#160;    &lt;a class="code" href="structDropout.html#aacd2c2da4fb3bd6718b2b43bc26538b9"&gt;set_dev&lt;/a&gt;(dev);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00126"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  126&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#endif&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00127"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  127&lt;/span&gt;&amp;#160;  }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00134"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="structDropout.html#a34adb045be5a2a9546ff99fec3ba1f30"&gt;  134&lt;/a&gt;&lt;/span&gt;&amp;#160;  &lt;span class="keywordtype"&gt;void&lt;/span&gt; &lt;a class="code" href="structDropout.html#a34adb045be5a2a9546ff99fec3ba1f30"&gt;del_dev&lt;/a&gt;() {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00135"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  135&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#if __NVCC__&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00136"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  136&lt;/span&gt;&amp;#160;    &lt;span class="keywordflow"&gt;if&lt;/span&gt; (opt.&lt;a class="code" href="structcmdline__opt.html#acb8b225214983d009415a26f2e45eb65"&gt;gpu_algo&lt;/a&gt;) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00137"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  137&lt;/span&gt;&amp;#160;      assert(dev);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00138"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  138&lt;/span&gt;&amp;#160;      &lt;a class="code" href="cuda__util_8h.html#ade14b7c582717d436e547ed0fcf8e4fe"&gt;dev_free&lt;/a&gt;(dev);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00139"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  139&lt;/span&gt;&amp;#160;      dev = 0;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00140"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  140&lt;/span&gt;&amp;#160;    }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00141"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  141&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#endif&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00142"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  142&lt;/span&gt;&amp;#160;  }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00147"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="structDropout.html#afbc57376fb281fd9ab79851c9a9af0fa"&gt;  147&lt;/a&gt;&lt;/span&gt;&amp;#160;  &lt;span class="keywordtype"&gt;void&lt;/span&gt; &lt;a class="code" href="structDropout.html#afbc57376fb281fd9ab79851c9a9af0fa"&gt;to_dev&lt;/a&gt;() {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00148"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  148&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#if __NVCC__&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00149"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  149&lt;/span&gt;&amp;#160;    &lt;span class="keywordflow"&gt;if&lt;/span&gt; (opt.&lt;a class="code" href="structcmdline__opt.html#acb8b225214983d009415a26f2e45eb65"&gt;gpu_algo&lt;/a&gt;) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00150"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  150&lt;/span&gt;&amp;#160;      assert(dev);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00151"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  151&lt;/span&gt;&amp;#160;      &lt;a class="code" href="structDropout.html#afbc57376fb281fd9ab79851c9a9af0fa"&gt;::to_dev&lt;/a&gt;(dev, &lt;span class="keyword"&gt;this&lt;/span&gt;, &lt;span class="keyword"&gt;sizeof&lt;/span&gt;(*&lt;span class="keyword"&gt;this&lt;/span&gt;));&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00152"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  152&lt;/span&gt;&amp;#160;    }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00153"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  153&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#endif&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00154"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  154&lt;/span&gt;&amp;#160;  }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00159"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="structDropout.html#a69ab2243eeca5c39bf88540aed92fcdc"&gt;  159&lt;/a&gt;&lt;/span&gt;&amp;#160;  &lt;span class="keywordtype"&gt;void&lt;/span&gt; &lt;a class="code" href="structDropout.html#a69ab2243eeca5c39bf88540aed92fcdc"&gt;to_host&lt;/a&gt;() {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00160"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  160&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#if __NVCC__&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00161"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  161&lt;/span&gt;&amp;#160;    &lt;span class="keywordflow"&gt;if&lt;/span&gt; (opt.&lt;a class="code" href="structcmdline__opt.html#acb8b225214983d009415a26f2e45eb65"&gt;gpu_algo&lt;/a&gt;) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00162"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  162&lt;/span&gt;&amp;#160;      assert(dev);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00163"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  163&lt;/span&gt;&amp;#160;      &lt;a class="code" href="structDropout.html"&gt;Dropout&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;* dev_ = &lt;a class="code" href="structDropout.html#a2ce2e6920dfb911f679af91ff9b6de55"&gt;dev&lt;/a&gt;;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00164"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  164&lt;/span&gt;&amp;#160;      &lt;a class="code" href="structDropout.html#a69ab2243eeca5c39bf88540aed92fcdc"&gt;::to_host&lt;/a&gt;(&lt;span class="keyword"&gt;this&lt;/span&gt;, dev_, &lt;span class="keyword"&gt;sizeof&lt;/span&gt;(*&lt;span class="keyword"&gt;this&lt;/span&gt;));&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00165"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  165&lt;/span&gt;&amp;#160;      assert(dev_ == dev);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00166"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  166&lt;/span&gt;&amp;#160;    }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00167"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  167&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#endif&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00168"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  168&lt;/span&gt;&amp;#160;  }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00181"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  181&lt;/span&gt;&amp;#160;  __device__ __host__&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00182"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="structDropout.html#a8d7db70a48a4c2e3887c931b099f1160"&gt;  182&lt;/a&gt;&lt;/span&gt;&amp;#160;  &lt;span class="keywordtype"&gt;void&lt;/span&gt; &lt;a class="code" href="structDropout.html#a8d7db70a48a4c2e3887c931b099f1160"&gt;forward_base&lt;/a&gt;(&lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;&amp;amp; x) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00183"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  183&lt;/span&gt;&amp;#160;    &lt;span class="keyword"&gt;const&lt;/span&gt; &lt;a class="code" href="vgg__util_8h.html#a8e93478a00e685bea5e6a3f617bf03a3"&gt;idx_t&lt;/a&gt; B = x.&lt;a class="code" href="structarray4.html#a68aee457ea4034e17475b6ec5c497c12"&gt;B&lt;/a&gt;;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00184"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  184&lt;/span&gt;&amp;#160;    y.&lt;a class="code" href="structarray4.html#a202d1a80c9bb76b2fb34e1c2e3146127"&gt;set_n_rows&lt;/a&gt;(B);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00185"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  185&lt;/span&gt;&amp;#160;    &lt;span class="comment"&gt;/* zero elements with probability of ratio and&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00186"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  186&lt;/span&gt;&amp;#160;&lt;span class="comment"&gt;       scale others by 1/(1-ratio) so that the sum &lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00187"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  187&lt;/span&gt;&amp;#160;&lt;span class="comment"&gt;       will stay approximately the same */&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00188"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  188&lt;/span&gt;&amp;#160;    state_forward = rg.&lt;a class="code" href="structrnd__gen__t.html#a45c7eb16a8f87359f70e007a00cf92e4"&gt;get_state&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00189"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  189&lt;/span&gt;&amp;#160;    &lt;a class="code" href="vgg__util_8h.html#a1082d08aaa761215ec83e7149f27ad16"&gt;real&lt;/a&gt; scale = 1.0 / (1 - &lt;a class="code" href="structDropout.html#a4181a1bcb986c62b1c6a82a3c1e03d9f"&gt;drop_ratio&lt;/a&gt;);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00190"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  190&lt;/span&gt;&amp;#160;    &lt;span class="keywordflow"&gt;for&lt;/span&gt; (&lt;a class="code" href="vgg__util_8h.html#a8e93478a00e685bea5e6a3f617bf03a3"&gt;idx_t&lt;/a&gt; b = 0; b &amp;lt; B; b++) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00191"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  191&lt;/span&gt;&amp;#160;      &lt;span class="keywordflow"&gt;for&lt;/span&gt; (&lt;a class="code" href="vgg__util_8h.html#a8e93478a00e685bea5e6a3f617bf03a3"&gt;idx_t&lt;/a&gt; c = 0; c &amp;lt; C; c++) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00192"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  192&lt;/span&gt;&amp;#160;        &lt;span class="keywordflow"&gt;for&lt;/span&gt; (&lt;a class="code" href="vgg__util_8h.html#a8e93478a00e685bea5e6a3f617bf03a3"&gt;idx_t&lt;/a&gt; i = 0; i &amp;lt; H; i++) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00193"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  193&lt;/span&gt;&amp;#160;          &lt;span class="keywordflow"&gt;for&lt;/span&gt; (&lt;a class="code" href="vgg__util_8h.html#a8e93478a00e685bea5e6a3f617bf03a3"&gt;idx_t&lt;/a&gt; j = 0; j &amp;lt; W; j++) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00194"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  194&lt;/span&gt;&amp;#160;            &lt;span class="keywordflow"&gt;if&lt;/span&gt; (rg.&lt;a class="code" href="structrnd__gen__t.html#abcddd9ef63e9228770b4e6a77f1aaaa8"&gt;rand01&lt;/a&gt;() &amp;lt; &lt;a class="code" href="structDropout.html#a4181a1bcb986c62b1c6a82a3c1e03d9f"&gt;drop_ratio&lt;/a&gt;) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00195"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  195&lt;/span&gt;&amp;#160;              &lt;a class="code" href="structDropout.html#ad758df2bfbd791e6b25e29c8204e0df4"&gt;y&lt;/a&gt;(b,c,i,j) = 0.0;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00196"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  196&lt;/span&gt;&amp;#160;            } &lt;span class="keywordflow"&gt;else&lt;/span&gt; {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00197"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  197&lt;/span&gt;&amp;#160;              &lt;a class="code" href="structDropout.html#ad758df2bfbd791e6b25e29c8204e0df4"&gt;y&lt;/a&gt;(b,c,i,j) = x(b,c,i,j) * scale;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00198"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  198&lt;/span&gt;&amp;#160;            }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00199"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  199&lt;/span&gt;&amp;#160;          }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00200"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  200&lt;/span&gt;&amp;#160;        }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00201"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  201&lt;/span&gt;&amp;#160;      }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00202"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  202&lt;/span&gt;&amp;#160;    }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00203"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  203&lt;/span&gt;&amp;#160;  }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00204"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  204&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#if __NVCC__&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00205"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  205&lt;/span&gt;&amp;#160;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00214"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  214&lt;/span&gt;&amp;#160;  __device__&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00215"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="structDropout.html#a81ee0268c4195380873af8ced5b1acc7"&gt;  215&lt;/a&gt;&lt;/span&gt;&amp;#160;  &lt;span class="keywordtype"&gt;void&lt;/span&gt; &lt;a class="code" href="structDropout.html#a81ee0268c4195380873af8ced5b1acc7"&gt;forward_dev&lt;/a&gt;(&lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;&amp;amp; x) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00216"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  216&lt;/span&gt;&amp;#160;    &lt;a class="code" href="structDropout.html#a8d7db70a48a4c2e3887c931b099f1160"&gt;forward_base&lt;/a&gt;(x);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00217"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  217&lt;/span&gt;&amp;#160;  }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00227"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="structDropout.html#a3bb7569a99e88c36e508bee45f379fad"&gt;  227&lt;/a&gt;&lt;/span&gt;&amp;#160;  &lt;span class="keywordtype"&gt;void&lt;/span&gt; &lt;a class="code" href="structDropout.html#a3bb7569a99e88c36e508bee45f379fad"&gt;forward_gpu&lt;/a&gt;(&lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;&amp;amp; x) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00228"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  228&lt;/span&gt;&amp;#160;    &lt;a class="code" href="cuda__util_8h.html#ae7d73cb485e300b743d0cb70eaa38f31"&gt;launch_and_sync&lt;/a&gt;((&lt;a class="code" href="dropout_8h.html#a481b6aac35e6819a36e87b00866a2cf8"&gt;forward_global&lt;/a&gt;&amp;lt;&amp;lt;&amp;lt;1,1&amp;gt;&amp;gt;&amp;gt;(dev, x.&lt;a class="code" href="structarray4.html#a19e463f2ae72c48b92ac558f06366a17"&gt;dev&lt;/a&gt;)));&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00229"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  229&lt;/span&gt;&amp;#160;  }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00230"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  230&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#endif&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00231"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  231&lt;/span&gt;&amp;#160;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00238"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="structDropout.html#a2adc263cee9f2d84a8d0729ffaf924a6"&gt;  238&lt;/a&gt;&lt;/span&gt;&amp;#160;  &lt;span class="keywordtype"&gt;void&lt;/span&gt; &lt;a class="code" href="structDropout.html#a2adc263cee9f2d84a8d0729ffaf924a6"&gt;forward_cpu&lt;/a&gt;(&lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;&amp;amp; x) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00239"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  239&lt;/span&gt;&amp;#160;    &lt;a class="code" href="structDropout.html#a8d7db70a48a4c2e3887c931b099f1160"&gt;forward_base&lt;/a&gt;(x);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00240"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  240&lt;/span&gt;&amp;#160;  }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00247"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="structDropout.html#a155eb3ad77df591bdd95645fec1f2089"&gt;  247&lt;/a&gt;&lt;/span&gt;&amp;#160;  &lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,W,H&amp;gt;&lt;/a&gt;&amp;amp; &lt;a class="code" href="structDropout.html#a155eb3ad77df591bdd95645fec1f2089"&gt;forward&lt;/a&gt;(&lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;&amp;amp; x) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00248"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  248&lt;/span&gt;&amp;#160;    &lt;a class="code" href="vgg__util_8h.html#a3729b3313855ba6b5af5e17b237c3558"&gt;log_start_fun&lt;/a&gt;(lgr);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00249"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  249&lt;/span&gt;&amp;#160;    &lt;a class="code" href="structtsc__t.html"&gt;tsc_t&lt;/a&gt; t0 = &lt;a class="code" href="vgg__util_8h.html#a77ac450375c73868fcb54ca2ecae1ba2"&gt;get_tsc&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00250"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  250&lt;/span&gt;&amp;#160;    &lt;span class="keywordflow"&gt;switch&lt;/span&gt; (opt.&lt;a class="code" href="structcmdline__opt.html#a4506cc13417cfb1379411fb497ae3c39"&gt;algo&lt;/a&gt;) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00251"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  251&lt;/span&gt;&amp;#160;      &lt;span class="comment"&gt;/* add case for your implementations here */&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00252"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  252&lt;/span&gt;&amp;#160;    &lt;span class="keywordflow"&gt;case&lt;/span&gt; algo_cpu_base:&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00253"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  253&lt;/span&gt;&amp;#160;      &lt;a class="code" href="structDropout.html#a2adc263cee9f2d84a8d0729ffaf924a6"&gt;forward_cpu&lt;/a&gt;(x); &lt;span class="keywordflow"&gt;break&lt;/span&gt;;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00254"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  254&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#if __NVCC__&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00255"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  255&lt;/span&gt;&amp;#160;    &lt;span class="keywordflow"&gt;case&lt;/span&gt; algo_gpu_base:&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00256"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  256&lt;/span&gt;&amp;#160;      &lt;a class="code" href="structDropout.html#a3bb7569a99e88c36e508bee45f379fad"&gt;forward_gpu&lt;/a&gt;(x); &lt;span class="keywordflow"&gt;break&lt;/span&gt;;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00257"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  257&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#endif&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00258"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  258&lt;/span&gt;&amp;#160;    &lt;span class="keywordflow"&gt;default&lt;/span&gt;:&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00259"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  259&lt;/span&gt;&amp;#160;      &lt;span class="keywordflow"&gt;if&lt;/span&gt; (opt.&lt;a class="code" href="structcmdline__opt.html#acb8b225214983d009415a26f2e45eb65"&gt;gpu_algo&lt;/a&gt;) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00260"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  260&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#if __NVCC__&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00261"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  261&lt;/span&gt;&amp;#160;        &lt;a class="code" href="structDropout.html#a3bb7569a99e88c36e508bee45f379fad"&gt;forward_gpu&lt;/a&gt;(x);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00262"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  262&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#else&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00263"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  263&lt;/span&gt;&amp;#160;        &lt;a class="code" href="vgg__util_8h.html#a5451ba9b35b36fff317b514218f7fcb8"&gt;err_gpu_algo_no_gpu&lt;/a&gt;(opt.&lt;a class="code" href="structcmdline__opt.html#aa5b05fde2a12fcab6f9ce0baf3e29d29"&gt;algo_s&lt;/a&gt;);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00264"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  264&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#endif&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00265"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  265&lt;/span&gt;&amp;#160;      } &lt;span class="keywordflow"&gt;else&lt;/span&gt; {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00266"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  266&lt;/span&gt;&amp;#160;        &lt;a class="code" href="structDropout.html#a2adc263cee9f2d84a8d0729ffaf924a6"&gt;forward_cpu&lt;/a&gt;(x);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00267"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  267&lt;/span&gt;&amp;#160;      }        &lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00268"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  268&lt;/span&gt;&amp;#160;    }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00269"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  269&lt;/span&gt;&amp;#160;    &lt;a class="code" href="structtsc__t.html"&gt;tsc_t&lt;/a&gt; t1 = &lt;a class="code" href="vgg__util_8h.html#a77ac450375c73868fcb54ca2ecae1ba2"&gt;get_tsc&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00270"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  270&lt;/span&gt;&amp;#160;    &lt;a class="code" href="vgg__util_8h.html#ac27fe6f3d72940b92349035afd50ec6f"&gt;log_end_fun&lt;/a&gt;(lgr, t0, t1);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00271"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  271&lt;/span&gt;&amp;#160;    &lt;span class="keywordflow"&gt;return&lt;/span&gt; &lt;a class="code" href="structDropout.html#ad758df2bfbd791e6b25e29c8204e0df4"&gt;y&lt;/a&gt;;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00272"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  272&lt;/span&gt;&amp;#160;  }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00285"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  285&lt;/span&gt;&amp;#160;  __device__ __host__&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00286"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="structDropout.html#a8ea26e89ddc6b5e4546f5a6ed019ad9a"&gt;  286&lt;/a&gt;&lt;/span&gt;&amp;#160;  &lt;span class="keywordtype"&gt;void&lt;/span&gt; &lt;a class="code" href="structDropout.html#a8ea26e89ddc6b5e4546f5a6ed019ad9a"&gt;backward_base&lt;/a&gt;(&lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;&amp;amp; gy) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00287"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  287&lt;/span&gt;&amp;#160;    &lt;span class="keyword"&gt;const&lt;/span&gt; &lt;a class="code" href="vgg__util_8h.html#a8e93478a00e685bea5e6a3f617bf03a3"&gt;idx_t&lt;/a&gt; B = gy.&lt;a class="code" href="structarray4.html#a68aee457ea4034e17475b6ec5c497c12"&gt;B&lt;/a&gt;;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00288"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  288&lt;/span&gt;&amp;#160;    gx.&lt;a class="code" href="structarray4.html#a202d1a80c9bb76b2fb34e1c2e3146127"&gt;set_n_rows&lt;/a&gt;(B);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00289"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  289&lt;/span&gt;&amp;#160;    rg.&lt;a class="code" href="structrnd__gen__t.html#a0e43f9b2d156cb2535bfa1a88cd9eb25"&gt;seed&lt;/a&gt;(state_forward);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00290"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  290&lt;/span&gt;&amp;#160;    &lt;a class="code" href="vgg__util_8h.html#a1082d08aaa761215ec83e7149f27ad16"&gt;real&lt;/a&gt; scale = 1.0 / (1 - &lt;a class="code" href="structDropout.html#a4181a1bcb986c62b1c6a82a3c1e03d9f"&gt;drop_ratio&lt;/a&gt;);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00291"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  291&lt;/span&gt;&amp;#160;    &lt;span class="keywordflow"&gt;for&lt;/span&gt; (&lt;a class="code" href="vgg__util_8h.html#a8e93478a00e685bea5e6a3f617bf03a3"&gt;idx_t&lt;/a&gt; b = 0; b &amp;lt; B; b++) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00292"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  292&lt;/span&gt;&amp;#160;      &lt;span class="keywordflow"&gt;for&lt;/span&gt; (&lt;a class="code" href="vgg__util_8h.html#a8e93478a00e685bea5e6a3f617bf03a3"&gt;idx_t&lt;/a&gt; c = 0; c &amp;lt; C; c++) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00293"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  293&lt;/span&gt;&amp;#160;        &lt;span class="keywordflow"&gt;for&lt;/span&gt; (&lt;a class="code" href="vgg__util_8h.html#a8e93478a00e685bea5e6a3f617bf03a3"&gt;idx_t&lt;/a&gt; i = 0; i &amp;lt; H; i++) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00294"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  294&lt;/span&gt;&amp;#160;          &lt;span class="keywordflow"&gt;for&lt;/span&gt; (&lt;a class="code" href="vgg__util_8h.html#a8e93478a00e685bea5e6a3f617bf03a3"&gt;idx_t&lt;/a&gt; j = 0; j &amp;lt; W; j++) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00295"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  295&lt;/span&gt;&amp;#160;            &lt;span class="keywordflow"&gt;if&lt;/span&gt; (rg.&lt;a class="code" href="structrnd__gen__t.html#abcddd9ef63e9228770b4e6a77f1aaaa8"&gt;rand01&lt;/a&gt;() &amp;lt; &lt;a class="code" href="structDropout.html#a4181a1bcb986c62b1c6a82a3c1e03d9f"&gt;drop_ratio&lt;/a&gt;) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00296"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  296&lt;/span&gt;&amp;#160;              &lt;a class="code" href="structDropout.html#a1cf5aced88d251c6b49772ad318bbd27"&gt;gx&lt;/a&gt;(b,c,i,j) = 0.0;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00297"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  297&lt;/span&gt;&amp;#160;            } &lt;span class="keywordflow"&gt;else&lt;/span&gt; {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00298"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  298&lt;/span&gt;&amp;#160;              &lt;a class="code" href="structDropout.html#a1cf5aced88d251c6b49772ad318bbd27"&gt;gx&lt;/a&gt;(b,c,i,j) = scale * gy(b,c,i,j);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00299"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  299&lt;/span&gt;&amp;#160;            }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00300"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  300&lt;/span&gt;&amp;#160;          }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00301"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  301&lt;/span&gt;&amp;#160;        }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00302"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  302&lt;/span&gt;&amp;#160;      }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00303"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  303&lt;/span&gt;&amp;#160;    }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00304"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  304&lt;/span&gt;&amp;#160;  }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00305"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  305&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#if __NVCC__&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00306"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  306&lt;/span&gt;&amp;#160;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00315"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  315&lt;/span&gt;&amp;#160;  __device__&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00316"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="structDropout.html#a5bbc54ad4125bf6768b5eeb17802a468"&gt;  316&lt;/a&gt;&lt;/span&gt;&amp;#160;  &lt;span class="keywordtype"&gt;void&lt;/span&gt; &lt;a class="code" href="structDropout.html#a5bbc54ad4125bf6768b5eeb17802a468"&gt;backward_dev&lt;/a&gt;(&lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;&amp;amp; gy) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00317"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  317&lt;/span&gt;&amp;#160;    &lt;a class="code" href="structDropout.html#a8ea26e89ddc6b5e4546f5a6ed019ad9a"&gt;backward_base&lt;/a&gt;(gy);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00318"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  318&lt;/span&gt;&amp;#160;  }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00328"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="structDropout.html#a138fbe07114851e478ac794629b6f44a"&gt;  328&lt;/a&gt;&lt;/span&gt;&amp;#160;  &lt;span class="keywordtype"&gt;void&lt;/span&gt; &lt;a class="code" href="structDropout.html#a138fbe07114851e478ac794629b6f44a"&gt;backward_gpu&lt;/a&gt;(&lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;&amp;amp; gy) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00329"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  329&lt;/span&gt;&amp;#160;    &lt;a class="code" href="cuda__util_8h.html#ae7d73cb485e300b743d0cb70eaa38f31"&gt;launch_and_sync&lt;/a&gt;((&lt;a class="code" href="dropout_8h.html#a1eba1ae8b54b7b1ac7da64793993f58a"&gt;backward_global&lt;/a&gt;&amp;lt;&amp;lt;&amp;lt;1,1&amp;gt;&amp;gt;&amp;gt;(dev, gy.&lt;a class="code" href="structarray4.html#a19e463f2ae72c48b92ac558f06366a17"&gt;dev&lt;/a&gt;)));&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00330"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  330&lt;/span&gt;&amp;#160;  }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00331"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  331&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#endif&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00332"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  332&lt;/span&gt;&amp;#160;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00339"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="structDropout.html#a6f78f35970607365a64e5f447bed4c04"&gt;  339&lt;/a&gt;&lt;/span&gt;&amp;#160;  &lt;span class="keywordtype"&gt;void&lt;/span&gt; &lt;a class="code" href="structDropout.html#a6f78f35970607365a64e5f447bed4c04"&gt;backward_cpu&lt;/a&gt;(&lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;&amp;amp; gy) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00340"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  340&lt;/span&gt;&amp;#160;    &lt;a class="code" href="structDropout.html#a8ea26e89ddc6b5e4546f5a6ed019ad9a"&gt;backward_base&lt;/a&gt;(gy);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00341"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  341&lt;/span&gt;&amp;#160;  }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00353"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="structDropout.html#afe1afe7ce80e59d1b48c820a724aae1b"&gt;  353&lt;/a&gt;&lt;/span&gt;&amp;#160;  &lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;&amp;amp; &lt;a class="code" href="structDropout.html#afe1afe7ce80e59d1b48c820a724aae1b"&gt;backward&lt;/a&gt;(&lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;&amp;amp; gy) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00354"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  354&lt;/span&gt;&amp;#160;    &lt;a class="code" href="vgg__util_8h.html#a3729b3313855ba6b5af5e17b237c3558"&gt;log_start_fun&lt;/a&gt;(lgr);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00355"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  355&lt;/span&gt;&amp;#160;    &lt;a class="code" href="structtsc__t.html"&gt;tsc_t&lt;/a&gt; t0 = &lt;a class="code" href="vgg__util_8h.html#a77ac450375c73868fcb54ca2ecae1ba2"&gt;get_tsc&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00356"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  356&lt;/span&gt;&amp;#160;    &lt;span class="keywordflow"&gt;switch&lt;/span&gt; (opt.&lt;a class="code" href="structcmdline__opt.html#a4506cc13417cfb1379411fb497ae3c39"&gt;algo&lt;/a&gt;) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00357"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  357&lt;/span&gt;&amp;#160;      &lt;span class="comment"&gt;/* add case for your implementations here */&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00358"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  358&lt;/span&gt;&amp;#160;    &lt;span class="keywordflow"&gt;case&lt;/span&gt; algo_cpu_base:&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00359"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  359&lt;/span&gt;&amp;#160;      &lt;a class="code" href="structDropout.html#a6f78f35970607365a64e5f447bed4c04"&gt;backward_cpu&lt;/a&gt;(gy); &lt;span class="keywordflow"&gt;break&lt;/span&gt;;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00360"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  360&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#if __NVCC__&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00361"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  361&lt;/span&gt;&amp;#160;    &lt;span class="keywordflow"&gt;case&lt;/span&gt; algo_gpu_base:&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00362"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  362&lt;/span&gt;&amp;#160;      &lt;a class="code" href="structDropout.html#a138fbe07114851e478ac794629b6f44a"&gt;backward_gpu&lt;/a&gt;(gy); &lt;span class="keywordflow"&gt;break&lt;/span&gt;;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00363"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  363&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#endif&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00364"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  364&lt;/span&gt;&amp;#160;    &lt;span class="keywordflow"&gt;default&lt;/span&gt;:&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00365"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  365&lt;/span&gt;&amp;#160;      &lt;span class="keywordflow"&gt;if&lt;/span&gt; (opt.&lt;a class="code" href="structcmdline__opt.html#acb8b225214983d009415a26f2e45eb65"&gt;gpu_algo&lt;/a&gt;) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00366"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  366&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#if __NVCC__&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00367"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  367&lt;/span&gt;&amp;#160;        &lt;a class="code" href="structDropout.html#a138fbe07114851e478ac794629b6f44a"&gt;backward_gpu&lt;/a&gt;(gy);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00368"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  368&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#else&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00369"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  369&lt;/span&gt;&amp;#160;        &lt;a class="code" href="vgg__util_8h.html#a5451ba9b35b36fff317b514218f7fcb8"&gt;err_gpu_algo_no_gpu&lt;/a&gt;(opt.&lt;a class="code" href="structcmdline__opt.html#aa5b05fde2a12fcab6f9ce0baf3e29d29"&gt;algo_s&lt;/a&gt;);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00370"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  370&lt;/span&gt;&amp;#160;&lt;span class="preprocessor"&gt;#endif&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00371"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  371&lt;/span&gt;&amp;#160;      } &lt;span class="keywordflow"&gt;else&lt;/span&gt; {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00372"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  372&lt;/span&gt;&amp;#160;        &lt;a class="code" href="structDropout.html#a6f78f35970607365a64e5f447bed4c04"&gt;backward_cpu&lt;/a&gt;(gy);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00373"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  373&lt;/span&gt;&amp;#160;      }        &lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00374"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  374&lt;/span&gt;&amp;#160;    }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00375"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  375&lt;/span&gt;&amp;#160;    &lt;a class="code" href="structtsc__t.html"&gt;tsc_t&lt;/a&gt; t1 = &lt;a class="code" href="vgg__util_8h.html#a77ac450375c73868fcb54ca2ecae1ba2"&gt;get_tsc&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00376"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  376&lt;/span&gt;&amp;#160;    &lt;a class="code" href="vgg__util_8h.html#ac27fe6f3d72940b92349035afd50ec6f"&gt;log_end_fun&lt;/a&gt;(lgr, t0, t1);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00377"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  377&lt;/span&gt;&amp;#160;    &lt;span class="keywordflow"&gt;return&lt;/span&gt; &lt;a class="code" href="structDropout.html#a1cf5aced88d251c6b49772ad318bbd27"&gt;gx&lt;/a&gt;;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00378"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  378&lt;/span&gt;&amp;#160;  }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00379"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  379&lt;/span&gt;&amp;#160;};&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00380"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  380&lt;/span&gt;&amp;#160;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00400"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  400&lt;/span&gt;&amp;#160;&lt;span class="keyword"&gt;template&lt;/span&gt;&amp;lt;&lt;span class="keywordtype"&gt;id&lt;/span&gt;x_t maxB,&lt;span class="keywordtype"&gt;id&lt;/span&gt;x_t C,&lt;span class="keywordtype"&gt;id&lt;/span&gt;x_t H,&lt;span class="keywordtype"&gt;id&lt;/span&gt;x_t W&amp;gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00401"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="dropout_8h.html#a3078a106aefd1416b053dfc6aa2cef8f"&gt;  401&lt;/a&gt;&lt;/span&gt;&amp;#160;  &lt;span class="keyword"&gt;static&lt;/span&gt; &lt;a class="code" href="vgg__util_8h.html#a1082d08aaa761215ec83e7149f27ad16"&gt;real&lt;/a&gt; &lt;a class="code" href="dropout_8h.html#a3078a106aefd1416b053dfc6aa2cef8f"&gt;dropout_grad_check_rand&lt;/a&gt;(&lt;a class="code" href="structcmdline__opt.html"&gt;cmdline_opt&lt;/a&gt; &lt;a class="code" href="structDropout.html#a3d9589e177c7fd00af8d7e82db651e48"&gt;opt&lt;/a&gt;, &lt;a class="code" href="structlogger.html"&gt;logger&lt;/a&gt; * &lt;a class="code" href="structDropout.html#a55a275be949499a6f3f27fcb9989964e"&gt;lgr&lt;/a&gt;, &lt;a class="code" href="structrnd__gen__t.html"&gt;rnd_gen_t&lt;/a&gt;&amp;amp; &lt;a class="code" href="structDropout.html#a176eb537c9aef161087863244f1e637f"&gt;rg&lt;/a&gt;, &lt;a class="code" href="vgg__util_8h.html#a8e93478a00e685bea5e6a3f617bf03a3"&gt;idx_t&lt;/a&gt; B) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00402"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  402&lt;/span&gt;&amp;#160;  &lt;span class="comment"&gt;/* initialize dropout parameters */&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00403"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  403&lt;/span&gt;&amp;#160;  &lt;span class="keyword"&gt;const&lt;/span&gt; &lt;a class="code" href="vgg__util_8h.html#a1082d08aaa761215ec83e7149f27ad16"&gt;real&lt;/a&gt; &lt;a class="code" href="structDropout.html#a4181a1bcb986c62b1c6a82a3c1e03d9f"&gt;drop_ratio&lt;/a&gt; = 0.3;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00404"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  404&lt;/span&gt;&amp;#160;  &lt;a class="code" href="structDropout.html"&gt;Dropout&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt; * dropout = &lt;span class="keyword"&gt;new&lt;/span&gt; &lt;a class="code" href="structDropout.html"&gt;Dropout&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00405"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  405&lt;/span&gt;&amp;#160;  dropout-&amp;gt;&lt;a class="code" href="structDropout.html#ab684bc3308abad8598f76bdaaa2598ee"&gt;init&lt;/a&gt;(opt, lgr, drop_ratio, opt.&lt;a class="code" href="structcmdline__opt.html#a8618cfd6b437743f58258b580d59b466"&gt;dropout_seed&lt;/a&gt;);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00406"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  406&lt;/span&gt;&amp;#160;  dropout-&amp;gt;&lt;a class="code" href="structDropout.html#ad1ea86b3d3240a95c9b8c52756ef23a9"&gt;make_dev&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00407"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  407&lt;/span&gt;&amp;#160;  dropout-&amp;gt;&lt;a class="code" href="structDropout.html#afbc57376fb281fd9ab79851c9a9af0fa"&gt;to_dev&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00408"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  408&lt;/span&gt;&amp;#160;  &lt;span class="comment"&gt;/* make copies */&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00409"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  409&lt;/span&gt;&amp;#160;  &lt;a class="code" href="structDropout.html"&gt;Dropout&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt; * dropout_minus = dropout-&amp;gt;&lt;a class="code" href="structDropout.html#a364b0df75c98d5b73fd11a77bf11bf89"&gt;copy&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00410"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  410&lt;/span&gt;&amp;#160;  &lt;a class="code" href="structDropout.html"&gt;Dropout&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt; * dropout_plus  = dropout-&amp;gt;&lt;a class="code" href="structDropout.html#a364b0df75c98d5b73fd11a77bf11bf89"&gt;copy&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00411"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  411&lt;/span&gt;&amp;#160;  &lt;span class="comment"&gt;/* make coefficients to make the single loss value */&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00412"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  412&lt;/span&gt;&amp;#160;  &lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt; * alpha = &lt;span class="keyword"&gt;new&lt;/span&gt; &lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00413"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  413&lt;/span&gt;&amp;#160;  alpha-&amp;gt;&lt;a class="code" href="structarray4.html#a05126cf0d9fec621264e095d587864da"&gt;make_dev&lt;/a&gt;(opt.&lt;a class="code" href="structcmdline__opt.html#acb8b225214983d009415a26f2e45eb65"&gt;gpu_algo&lt;/a&gt;);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00414"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  414&lt;/span&gt;&amp;#160;  alpha-&amp;gt;&lt;a class="code" href="structarray4.html#ab4374d21733665dbda4acaf2aeccb1df"&gt;init_uniform&lt;/a&gt;(B, rg, 0.0, 1.0);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00415"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  415&lt;/span&gt;&amp;#160;  alpha-&amp;gt;&lt;a class="code" href="structarray4.html#a98fbca33be98702d92368dba1386a879"&gt;to_dev&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00416"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  416&lt;/span&gt;&amp;#160;  &lt;span class="comment"&gt;/* make input (x) */&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00417"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  417&lt;/span&gt;&amp;#160;  &lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt; * x = &lt;span class="keyword"&gt;new&lt;/span&gt; &lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00418"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  418&lt;/span&gt;&amp;#160;  x-&amp;gt;&lt;a class="code" href="structarray4.html#a05126cf0d9fec621264e095d587864da"&gt;make_dev&lt;/a&gt;(opt.&lt;a class="code" href="structcmdline__opt.html#acb8b225214983d009415a26f2e45eb65"&gt;gpu_algo&lt;/a&gt;);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00419"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  419&lt;/span&gt;&amp;#160;  x-&amp;gt;&lt;a class="code" href="structarray4.html#ab4374d21733665dbda4acaf2aeccb1df"&gt;init_uniform&lt;/a&gt;(B, rg, 0.0, 1.0);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00420"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  420&lt;/span&gt;&amp;#160;  x-&amp;gt;&lt;a class="code" href="structarray4.html#a98fbca33be98702d92368dba1386a879"&gt;to_dev&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00421"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  421&lt;/span&gt;&amp;#160;  &lt;span class="comment"&gt;/* forward and backward */&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00422"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  422&lt;/span&gt;&amp;#160;  &lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,W,H&amp;gt;&lt;/a&gt;&amp;amp; &lt;a class="code" href="structDropout.html#ad758df2bfbd791e6b25e29c8204e0df4"&gt;y&lt;/a&gt; = dropout-&amp;gt;&lt;a class="code" href="structDropout.html#a155eb3ad77df591bdd95645fec1f2089"&gt;forward&lt;/a&gt;(*x);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00423"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  423&lt;/span&gt;&amp;#160;  &lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;&amp;amp; &lt;a class="code" href="structDropout.html#a1cf5aced88d251c6b49772ad318bbd27"&gt;gx&lt;/a&gt; = dropout-&amp;gt;&lt;a class="code" href="structDropout.html#afe1afe7ce80e59d1b48c820a724aae1b"&gt;backward&lt;/a&gt;(*alpha);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00424"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  424&lt;/span&gt;&amp;#160;  dropout-&amp;gt;&lt;a class="code" href="structDropout.html#a69ab2243eeca5c39bf88540aed92fcdc"&gt;to_host&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00425"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  425&lt;/span&gt;&amp;#160;  &lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00426"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  426&lt;/span&gt;&amp;#160;  &lt;span class="comment"&gt;/* make dx */&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00427"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  427&lt;/span&gt;&amp;#160;  &lt;a class="code" href="vgg__util_8h.html#a1082d08aaa761215ec83e7149f27ad16"&gt;real&lt;/a&gt; e = 1.0e-4;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00428"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  428&lt;/span&gt;&amp;#160;  &lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt; * dx = &lt;span class="keyword"&gt;new&lt;/span&gt; &lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00429"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  429&lt;/span&gt;&amp;#160;  dx-&amp;gt;&lt;a class="code" href="structarray4.html#ab4374d21733665dbda4acaf2aeccb1df"&gt;init_uniform&lt;/a&gt;(B, rg, -e, e);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00430"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  430&lt;/span&gt;&amp;#160;  &lt;span class="comment"&gt;/* make x - dx/2 and x + dx/2 */&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00431"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  431&lt;/span&gt;&amp;#160;  &lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt; * x_minus = &lt;span class="keyword"&gt;new&lt;/span&gt; &lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;(*x);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00432"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  432&lt;/span&gt;&amp;#160;  x_minus-&amp;gt;&lt;a class="code" href="structarray4.html#a05126cf0d9fec621264e095d587864da"&gt;make_dev&lt;/a&gt;(opt.&lt;a class="code" href="structcmdline__opt.html#acb8b225214983d009415a26f2e45eb65"&gt;gpu_algo&lt;/a&gt;);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00433"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  433&lt;/span&gt;&amp;#160;  &lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt; * x_plus  = &lt;span class="keyword"&gt;new&lt;/span&gt; &lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;(*x);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00434"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  434&lt;/span&gt;&amp;#160;  x_plus-&amp;gt;&lt;a class="code" href="structarray4.html#a05126cf0d9fec621264e095d587864da"&gt;make_dev&lt;/a&gt;(opt.&lt;a class="code" href="structcmdline__opt.html#acb8b225214983d009415a26f2e45eb65"&gt;gpu_algo&lt;/a&gt;);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00435"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  435&lt;/span&gt;&amp;#160;  x_minus-&amp;gt;&lt;a class="code" href="structarray4.html#aec956ca804fd9176479805bd753b4b1a"&gt;update&lt;/a&gt;(-0.5, *dx);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00436"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  436&lt;/span&gt;&amp;#160;  x_plus-&amp;gt;&lt;a class="code" href="structarray4.html#aec956ca804fd9176479805bd753b4b1a"&gt;update&lt;/a&gt;( 0.5, *dx);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00437"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  437&lt;/span&gt;&amp;#160;  x_minus-&amp;gt;&lt;a class="code" href="structarray4.html#a98fbca33be98702d92368dba1386a879"&gt;to_dev&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00438"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  438&lt;/span&gt;&amp;#160;  x_plus-&amp;gt;&lt;a class="code" href="structarray4.html#a98fbca33be98702d92368dba1386a879"&gt;to_dev&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00439"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  439&lt;/span&gt;&amp;#160;  &lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00440"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  440&lt;/span&gt;&amp;#160;  &lt;span class="comment"&gt;/* send copies to gpu */&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00441"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  441&lt;/span&gt;&amp;#160;  dropout_minus-&amp;gt;&lt;a class="code" href="structDropout.html#afbc57376fb281fd9ab79851c9a9af0fa"&gt;to_dev&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00442"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  442&lt;/span&gt;&amp;#160;  dropout_plus-&amp;gt;&lt;a class="code" href="structDropout.html#afbc57376fb281fd9ab79851c9a9af0fa"&gt;to_dev&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00443"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  443&lt;/span&gt;&amp;#160;  &lt;span class="comment"&gt;/* make y(x-dx/2), y(x+dx/2) */&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00444"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  444&lt;/span&gt;&amp;#160;  &lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;&amp;amp; y_minus = dropout_minus-&amp;gt;&lt;a class="code" href="structDropout.html#a155eb3ad77df591bdd95645fec1f2089"&gt;forward&lt;/a&gt;(*x_minus);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00445"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  445&lt;/span&gt;&amp;#160;  &lt;a class="code" href="structarray4.html"&gt;array4&amp;lt;maxB,C,H,W&amp;gt;&lt;/a&gt;&amp;amp; y_plus  = dropout_plus-&amp;gt;&lt;a class="code" href="structDropout.html#a155eb3ad77df591bdd95645fec1f2089"&gt;forward&lt;/a&gt;(*x_plus);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00446"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  446&lt;/span&gt;&amp;#160;  &lt;span class="comment"&gt;/* get the result back to host */&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00447"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  447&lt;/span&gt;&amp;#160;  y_minus.&lt;a class="code" href="structarray4.html#a4d32a5c08163fc8ad6fcc6c4ffb1cfe4"&gt;to_host&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00448"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  448&lt;/span&gt;&amp;#160;  y_plus.&lt;a class="code" href="structarray4.html#a4d32a5c08163fc8ad6fcc6c4ffb1cfe4"&gt;to_host&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00449"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  449&lt;/span&gt;&amp;#160;  &lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00450"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  450&lt;/span&gt;&amp;#160;  &lt;span class="comment"&gt;/* get the single loss values */&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00451"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  451&lt;/span&gt;&amp;#160;  &lt;a class="code" href="vgg__util_8h.html#a1082d08aaa761215ec83e7149f27ad16"&gt;real&lt;/a&gt; L_minus = alpha-&amp;gt;&lt;a class="code" href="structarray4.html#a3827cfcadd9a47c0f199ababeed1565c"&gt;dot&lt;/a&gt;(y_minus);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00452"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  452&lt;/span&gt;&amp;#160;  &lt;a class="code" href="vgg__util_8h.html#a1082d08aaa761215ec83e7149f27ad16"&gt;real&lt;/a&gt; L       = alpha-&amp;gt;&lt;a class="code" href="structarray4.html#a3827cfcadd9a47c0f199ababeed1565c"&gt;dot&lt;/a&gt;(y);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00453"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  453&lt;/span&gt;&amp;#160;  &lt;a class="code" href="vgg__util_8h.html#a1082d08aaa761215ec83e7149f27ad16"&gt;real&lt;/a&gt; L_plus  = alpha-&amp;gt;&lt;a class="code" href="structarray4.html#a3827cfcadd9a47c0f199ababeed1565c"&gt;dot&lt;/a&gt;(y_plus);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00454"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  454&lt;/span&gt;&amp;#160;  &lt;span class="comment"&gt;/* various inner products */&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00455"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  455&lt;/span&gt;&amp;#160;  &lt;a class="code" href="vgg__util_8h.html#a1082d08aaa761215ec83e7149f27ad16"&gt;real&lt;/a&gt; gx_gx = gx.&lt;a class="code" href="structarray4.html#a3827cfcadd9a47c0f199ababeed1565c"&gt;dot&lt;/a&gt;(gx);                         &lt;span class="comment"&gt;/* L/xL/x */&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00456"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  456&lt;/span&gt;&amp;#160;  &lt;a class="code" href="vgg__util_8h.html#a1082d08aaa761215ec83e7149f27ad16"&gt;real&lt;/a&gt; dx_dx = dx-&amp;gt;&lt;a class="code" href="structarray4.html#a3827cfcadd9a47c0f199ababeed1565c"&gt;dot&lt;/a&gt;(*dx);                       &lt;span class="comment"&gt;/* L/xdx */&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00457"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  457&lt;/span&gt;&amp;#160;  &lt;a class="code" href="vgg__util_8h.html#a1082d08aaa761215ec83e7149f27ad16"&gt;real&lt;/a&gt; gx_dx = gx.&lt;a class="code" href="structarray4.html#a3827cfcadd9a47c0f199ababeed1565c"&gt;dot&lt;/a&gt;(*dx);                        &lt;span class="comment"&gt;/* dxdx */&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00458"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  458&lt;/span&gt;&amp;#160;  &lt;a class="code" href="vgg__util_8h.html#a1082d08aaa761215ec83e7149f27ad16"&gt;real&lt;/a&gt; gw_gw = 0;                                  &lt;span class="comment"&gt;/* L/wL/w */&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00459"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  459&lt;/span&gt;&amp;#160;  &lt;a class="code" href="vgg__util_8h.html#a1082d08aaa761215ec83e7149f27ad16"&gt;real&lt;/a&gt; dw_dw = 0;                                  &lt;span class="comment"&gt;/* L/wdw */&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00460"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  460&lt;/span&gt;&amp;#160;  &lt;a class="code" href="vgg__util_8h.html#a1082d08aaa761215ec83e7149f27ad16"&gt;real&lt;/a&gt; gw_dw = 0;                                  &lt;span class="comment"&gt;/* dwdw */&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00461"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  461&lt;/span&gt;&amp;#160;  &lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00462"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  462&lt;/span&gt;&amp;#160;  &lt;a class="code" href="vgg__util_8h.html#a1082d08aaa761215ec83e7149f27ad16"&gt;real&lt;/a&gt; rel_e = &lt;a class="code" href="vgg__util_8h.html#acbdb5e7729d72687cf8a7bade538ebd0"&gt;show_error&lt;/a&gt;(gx_gx, dx_dx, gx_dx, gw_gw, dw_dw, gw_dw, L_minus, L, L_plus);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00463"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  463&lt;/span&gt;&amp;#160;  &lt;span class="comment"&gt;/* clean up */&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00464"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  464&lt;/span&gt;&amp;#160;  dropout-&amp;gt;&lt;a class="code" href="structDropout.html#a34adb045be5a2a9546ff99fec3ba1f30"&gt;del_dev&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00465"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  465&lt;/span&gt;&amp;#160;  dropout_minus-&amp;gt;&lt;a class="code" href="structDropout.html#a34adb045be5a2a9546ff99fec3ba1f30"&gt;del_dev&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00466"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  466&lt;/span&gt;&amp;#160;  dropout_plus-&amp;gt;&lt;a class="code" href="structDropout.html#a34adb045be5a2a9546ff99fec3ba1f30"&gt;del_dev&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00467"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  467&lt;/span&gt;&amp;#160;  alpha-&amp;gt;&lt;a class="code" href="structarray4.html#a53b8b089c3186e3bd2dc51f8a6c1533d"&gt;del_dev&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00468"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  468&lt;/span&gt;&amp;#160;  x-&amp;gt;&lt;a class="code" href="structarray4.html#a53b8b089c3186e3bd2dc51f8a6c1533d"&gt;del_dev&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00469"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  469&lt;/span&gt;&amp;#160;  dx-&amp;gt;&lt;a class="code" href="structarray4.html#a53b8b089c3186e3bd2dc51f8a6c1533d"&gt;del_dev&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00470"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  470&lt;/span&gt;&amp;#160;  x_minus-&amp;gt;&lt;a class="code" href="structarray4.html#a53b8b089c3186e3bd2dc51f8a6c1533d"&gt;del_dev&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00471"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  471&lt;/span&gt;&amp;#160;  x_plus-&amp;gt;&lt;a class="code" href="structarray4.html#a53b8b089c3186e3bd2dc51f8a6c1533d"&gt;del_dev&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00472"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  472&lt;/span&gt;&amp;#160;  &lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00473"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  473&lt;/span&gt;&amp;#160;  &lt;span class="keyword"&gt;delete&lt;/span&gt; dropout;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00474"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  474&lt;/span&gt;&amp;#160;  &lt;span class="keyword"&gt;delete&lt;/span&gt; dropout_minus;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00475"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  475&lt;/span&gt;&amp;#160;  &lt;span class="keyword"&gt;delete&lt;/span&gt; dropout_plus;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00476"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  476&lt;/span&gt;&amp;#160;  &lt;span class="keyword"&gt;delete&lt;/span&gt; alpha;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00477"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  477&lt;/span&gt;&amp;#160;  &lt;span class="keyword"&gt;delete&lt;/span&gt; x;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00478"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  478&lt;/span&gt;&amp;#160;  &lt;span class="keyword"&gt;delete&lt;/span&gt; dx;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00479"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  479&lt;/span&gt;&amp;#160;  &lt;span class="keyword"&gt;delete&lt;/span&gt; x_minus;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00480"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  480&lt;/span&gt;&amp;#160;  &lt;span class="keyword"&gt;delete&lt;/span&gt; x_plus;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00481"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  481&lt;/span&gt;&amp;#160;  &lt;span class="keywordflow"&gt;return&lt;/span&gt; rel_e;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00482"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  482&lt;/span&gt;&amp;#160;}&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00483"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  483&lt;/span&gt;&amp;#160;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00496"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;&lt;a class="line" href="dropout_8h.html#a4ef5b975a86f550ff6e75094a34a88bf"&gt;  496&lt;/a&gt;&lt;/span&gt;&amp;#160;&lt;span class="keywordtype"&gt;int&lt;/span&gt; &lt;a class="code" href="dropout_8h.html#a4ef5b975a86f550ff6e75094a34a88bf"&gt;dropout_main&lt;/a&gt;(&lt;span class="keywordtype"&gt;int&lt;/span&gt; argc, &lt;span class="keywordtype"&gt;char&lt;/span&gt; ** argv) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00497"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  497&lt;/span&gt;&amp;#160;  &lt;a class="code" href="structcmdline__opt.html"&gt;cmdline_opt&lt;/a&gt; &lt;a class="code" href="structDropout.html#a3d9589e177c7fd00af8d7e82db651e48"&gt;opt&lt;/a&gt; = &lt;a class="code" href="vgg__util_8h.html#aef68e2fab2ff620c9acef4ac2b6b3206"&gt;parse_args&lt;/a&gt;(argc, argv);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00498"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  498&lt;/span&gt;&amp;#160;  &lt;span class="keyword"&gt;const&lt;/span&gt; &lt;a class="code" href="vgg__util_8h.html#a8e93478a00e685bea5e6a3f617bf03a3"&gt;idx_t&lt;/a&gt; maxB = MAX_BATCH_SIZE;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00499"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  499&lt;/span&gt;&amp;#160;  &lt;span class="keyword"&gt;const&lt;/span&gt; &lt;a class="code" href="vgg__util_8h.html#a8e93478a00e685bea5e6a3f617bf03a3"&gt;idx_t&lt;/a&gt; B = &lt;a class="code" href="vgg__util_8h.html#a6a018ccb714ccf21ed5241d7d1200212"&gt;min_i&lt;/a&gt;(maxB, opt.&lt;a class="code" href="structcmdline__opt.html#a417b11f5b6a5213e293ce930a471a786"&gt;batch_sz&lt;/a&gt;);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00500"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  500&lt;/span&gt;&amp;#160;  &lt;span class="keyword"&gt;const&lt;/span&gt; &lt;a class="code" href="vgg__util_8h.html#a8e93478a00e685bea5e6a3f617bf03a3"&gt;idx_t&lt;/a&gt; C = 3;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00501"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  501&lt;/span&gt;&amp;#160;  &lt;span class="keyword"&gt;const&lt;/span&gt; &lt;a class="code" href="vgg__util_8h.html#a8e93478a00e685bea5e6a3f617bf03a3"&gt;idx_t&lt;/a&gt; H = 32;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00502"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  502&lt;/span&gt;&amp;#160;  &lt;span class="keyword"&gt;const&lt;/span&gt; &lt;a class="code" href="vgg__util_8h.html#a8e93478a00e685bea5e6a3f617bf03a3"&gt;idx_t&lt;/a&gt; W = 32;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00503"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  503&lt;/span&gt;&amp;#160;  &lt;span class="keyword"&gt;const&lt;/span&gt; &lt;span class="keywordtype"&gt;int&lt;/span&gt; n_checks = opt.&lt;a class="code" href="structcmdline__opt.html#a430664c4a225528c56f959765371755d"&gt;iters&lt;/a&gt;;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00504"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  504&lt;/span&gt;&amp;#160;  &lt;span class="comment"&gt;/* logger */&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00505"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  505&lt;/span&gt;&amp;#160;  &lt;a class="code" href="structlogger.html"&gt;logger&lt;/a&gt; &lt;a class="code" href="structDropout.html#a55a275be949499a6f3f27fcb9989964e"&gt;lgr&lt;/a&gt;;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00506"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  506&lt;/span&gt;&amp;#160;  lgr.&lt;a class="code" href="structlogger.html#a2d852f1f257849e0abed587814446908"&gt;start_log&lt;/a&gt;(opt);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00507"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  507&lt;/span&gt;&amp;#160;  &lt;span class="comment"&gt;/* initialize random number generator */&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00508"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  508&lt;/span&gt;&amp;#160;  &lt;a class="code" href="structrnd__gen__t.html"&gt;rnd_gen_t&lt;/a&gt; &lt;a class="code" href="structDropout.html#a176eb537c9aef161087863244f1e637f"&gt;rg&lt;/a&gt;;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00509"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  509&lt;/span&gt;&amp;#160;  rg.&lt;a class="code" href="structrnd__gen__t.html#a0e43f9b2d156cb2535bfa1a88cd9eb25"&gt;seed&lt;/a&gt;(opt.&lt;a class="code" href="structcmdline__opt.html#a70133aad1b243d44e1be18be81633939"&gt;weight_seed&lt;/a&gt;);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00510"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  510&lt;/span&gt;&amp;#160;  &lt;span class="comment"&gt;/* check errors */&lt;/span&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00511"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  511&lt;/span&gt;&amp;#160;  &lt;a class="code" href="vgg__util_8h.html#a1082d08aaa761215ec83e7149f27ad16"&gt;real&lt;/a&gt; max_e = 0.0;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00512"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  512&lt;/span&gt;&amp;#160;  &lt;a class="code" href="vgg__util_8h.html#a1082d08aaa761215ec83e7149f27ad16"&gt;real&lt;/a&gt; sum_e = 0.0;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00513"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  513&lt;/span&gt;&amp;#160;  &lt;span class="keywordflow"&gt;for&lt;/span&gt; (&lt;span class="keywordtype"&gt;int&lt;/span&gt; iter = 0; iter &amp;lt; n_checks; iter++) {&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00514"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  514&lt;/span&gt;&amp;#160;    printf(&lt;span class="stringliteral"&gt;&amp;quot;==== %d ====\n&amp;quot;&lt;/span&gt;, iter);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00515"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  515&lt;/span&gt;&amp;#160;    &lt;a class="code" href="vgg__util_8h.html#a1082d08aaa761215ec83e7149f27ad16"&gt;real&lt;/a&gt; e = dropout_grad_check_rand&amp;lt;maxB,C,H,W&amp;gt;(&lt;a class="code" href="structDropout.html#a3d9589e177c7fd00af8d7e82db651e48"&gt;opt&lt;/a&gt;, &amp;amp;&lt;a class="code" href="structDropout.html#a55a275be949499a6f3f27fcb9989964e"&gt;lgr&lt;/a&gt;, &lt;a class="code" href="structDropout.html#a176eb537c9aef161087863244f1e637f"&gt;rg&lt;/a&gt;, B);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00516"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  516&lt;/span&gt;&amp;#160;    max_e = &lt;a class="code" href="vgg__util_8h.html#ac365ac2e7b737d10f620cd27c0106bcf"&gt;max_r&lt;/a&gt;(max_e, e);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00517"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  517&lt;/span&gt;&amp;#160;    sum_e += e;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00518"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  518&lt;/span&gt;&amp;#160;  }&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00519"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  519&lt;/span&gt;&amp;#160;  printf(&lt;span class="stringliteral"&gt;&amp;quot;max relative error = %.9f\n&amp;quot;&lt;/span&gt;, max_e);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00520"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  520&lt;/span&gt;&amp;#160;  printf(&lt;span class="stringliteral"&gt;&amp;quot;avg relative error = %.9f\n&amp;quot;&lt;/span&gt;, sum_e / n_checks);&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00521"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  521&lt;/span&gt;&amp;#160;  lgr.&lt;a class="code" href="structlogger.html#ae79e87e0de219c9e001417f5b220c325"&gt;end_log&lt;/a&gt;();&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00522"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  522&lt;/span&gt;&amp;#160;  &lt;span class="keywordflow"&gt;return&lt;/span&gt; 0;&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00523"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  523&lt;/span&gt;&amp;#160;}&lt;/div&gt;&lt;div class="line"&gt;&lt;a name="l00524"&gt;&lt;/a&gt;&lt;span class="lineno"&gt;  524&lt;/span&gt;&amp;#160;&lt;/div&gt;&lt;div class="ttc" id="structDropout_html_a138fbe07114851e478ac794629b6f44a"&gt;&lt;div class="ttname"&gt;&lt;a href="structDropout.html#a138fbe07114851e478ac794629b6f44a"&gt;Dropout::backward_gpu&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;void backward_gpu(array4&amp;lt; maxB, C, H, W &amp;gt; &amp;amp;gy)&lt;/div&gt;&lt;div class="ttdoc"&gt;a gpu version of baseline code called from the entry function (backward) &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:328&lt;/div&gt;&lt;/div&gt;
<a id='L70' name='L70'></a>&lt;div class="ttc" id="structDropout_html_a8ea26e89ddc6b5e4546f5a6ed019ad9a"&gt;&lt;div class="ttname"&gt;&lt;a href="structDropout.html#a8ea26e89ddc6b5e4546f5a6ed019ad9a"&gt;Dropout::backward_base&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;__device__ __host__ void backward_base(array4&amp;lt; maxB, C, H, W &amp;gt; &amp;amp;gy)&lt;/div&gt;&lt;div class="ttdoc"&gt;the baseline (serial) implementation of backward called both by cpu implementation (backward_cpu) and...&lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:286&lt;/div&gt;&lt;/div&gt;
<a id='L71' name='L71'></a>&lt;div class="ttc" id="vgg__util_8h_html_aef68e2fab2ff620c9acef4ac2b6b3206"&gt;&lt;div class="ttname"&gt;&lt;a href="vgg__util_8h.html#aef68e2fab2ff620c9acef4ac2b6b3206"&gt;parse_args&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;static cmdline_opt parse_args(int argc, char **argv)&lt;/div&gt;&lt;div class="ttdoc"&gt;parse command line args and make a command line object &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_util.h:266&lt;/div&gt;&lt;/div&gt;
<a id='L72' name='L72'></a>&lt;div class="ttc" id="vgg__util_8h_html_a6a018ccb714ccf21ed5241d7d1200212"&gt;&lt;div class="ttname"&gt;&lt;a href="vgg__util_8h.html#a6a018ccb714ccf21ed5241d7d1200212"&gt;min_i&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;__device__ static __host__ idx_t min_i(idx_t a, idx_t b)&lt;/div&gt;&lt;div class="ttdoc"&gt;minimum of two ints &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_util.h:387&lt;/div&gt;&lt;/div&gt;
<a id='L73' name='L73'></a>&lt;div class="ttc" id="structcmdline__opt_html_a4506cc13417cfb1379411fb497ae3c39"&gt;&lt;div class="ttname"&gt;&lt;a href="structcmdline__opt.html#a4506cc13417cfb1379411fb497ae3c39"&gt;cmdline_opt::algo&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;algo_t algo&lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_util.h:150&lt;/div&gt;&lt;/div&gt;
<a id='L74' name='L74'></a>&lt;div class="ttc" id="dropout_8h_html_a481b6aac35e6819a36e87b00866a2cf8"&gt;&lt;div class="ttname"&gt;&lt;a href="dropout_8h.html#a481b6aac35e6819a36e87b00866a2cf8"&gt;forward_global&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;__global__ void forward_global(Dropout&amp;lt; maxB, C, H, W &amp;gt; *dev, array4&amp;lt; maxB, C, H, W &amp;gt; *x_dev)&lt;/div&gt;&lt;div class="ttdoc"&gt;a global CUDA function that implements the baseline forward function for GPU &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:23&lt;/div&gt;&lt;/div&gt;
<a id='L75' name='L75'></a>&lt;div class="ttc" id="structtsc__t_html"&gt;&lt;div class="ttname"&gt;&lt;a href="structtsc__t.html"&gt;tsc_t&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdoc"&gt;timestamp &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_util.h:394&lt;/div&gt;&lt;/div&gt;
<a id='L76' name='L76'></a>&lt;div class="ttc" id="vgg__util_8h_html_a3729b3313855ba6b5af5e17b237c3558"&gt;&lt;div class="ttname"&gt;&lt;a href="vgg__util_8h.html#a3729b3313855ba6b5af5e17b237c3558"&gt;log_start_fun&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;#define log_start_fun(lgr)&lt;/div&gt;&lt;div class="ttdoc"&gt;log the start of the current function &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_util.h:706&lt;/div&gt;&lt;/div&gt;
<a id='L77' name='L77'></a>&lt;div class="ttc" id="structDropout_html_ad758df2bfbd791e6b25e29c8204e0df4"&gt;&lt;div class="ttname"&gt;&lt;a href="structDropout.html#ad758df2bfbd791e6b25e29c8204e0df4"&gt;Dropout::y&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;array4&amp;lt; maxB, C, H, W &amp;gt; y&lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:67&lt;/div&gt;&lt;/div&gt;
<a id='L78' name='L78'></a>&lt;div class="ttc" id="structDropout_html_a6f78f35970607365a64e5f447bed4c04"&gt;&lt;div class="ttname"&gt;&lt;a href="structDropout.html#a6f78f35970607365a64e5f447bed4c04"&gt;Dropout::backward_cpu&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;void backward_cpu(array4&amp;lt; maxB, C, H, W &amp;gt; &amp;amp;gy)&lt;/div&gt;&lt;div class="ttdoc"&gt;a cpu version of baseline code called from the entry function (backward) &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:339&lt;/div&gt;&lt;/div&gt;
<a id='L79' name='L79'></a>&lt;div class="ttc" id="vgg__util_8h_html_ac365ac2e7b737d10f620cd27c0106bcf"&gt;&lt;div class="ttname"&gt;&lt;a href="vgg__util_8h.html#ac365ac2e7b737d10f620cd27c0106bcf"&gt;max_r&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;__device__ static __host__ real max_r(real a, real b)&lt;/div&gt;&lt;div class="ttdoc"&gt;maximum of two reals &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_util.h:363&lt;/div&gt;&lt;/div&gt;
<a id='L80' name='L80'></a>&lt;div class="ttc" id="structcmdline__opt_html_aa5b05fde2a12fcab6f9ce0baf3e29d29"&gt;&lt;div class="ttname"&gt;&lt;a href="structcmdline__opt.html#aa5b05fde2a12fcab6f9ce0baf3e29d29"&gt;cmdline_opt::algo_s&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;const char * algo_s&lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_util.h:149&lt;/div&gt;&lt;/div&gt;
<a id='L81' name='L81'></a>&lt;div class="ttc" id="structDropout_html_ab684bc3308abad8598f76bdaaa2598ee"&gt;&lt;div class="ttname"&gt;&lt;a href="structDropout.html#ab684bc3308abad8598f76bdaaa2598ee"&gt;Dropout::init&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;void init(cmdline_opt opt, logger *lgr, real drop_ratio, long drop_seed)&lt;/div&gt;&lt;div class="ttdoc"&gt;initialize &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:79&lt;/div&gt;&lt;/div&gt;
<a id='L82' name='L82'></a>&lt;div class="ttc" id="structDropout_html_a155eb3ad77df591bdd95645fec1f2089"&gt;&lt;div class="ttname"&gt;&lt;a href="structDropout.html#a155eb3ad77df591bdd95645fec1f2089"&gt;Dropout::forward&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;array4&amp;lt; maxB, C, W, H &amp;gt; &amp;amp; forward(array4&amp;lt; maxB, C, H, W &amp;gt; &amp;amp;x)&lt;/div&gt;&lt;div class="ttdoc"&gt;calc the loss function of a mini-batch (x) &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:247&lt;/div&gt;&lt;/div&gt;
<a id='L83' name='L83'></a>&lt;div class="ttc" id="dropout_8h_html_a4ef5b975a86f550ff6e75094a34a88bf"&gt;&lt;div class="ttname"&gt;&lt;a href="dropout_8h.html#a4ef5b975a86f550ff6e75094a34a88bf"&gt;dropout_main&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;int dropout_main(int argc, char **argv)&lt;/div&gt;&lt;div class="ttdoc"&gt;entry point of this header file &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:496&lt;/div&gt;&lt;/div&gt;
<a id='L84' name='L84'></a>&lt;div class="ttc" id="structDropout_html_a3bb7569a99e88c36e508bee45f379fad"&gt;&lt;div class="ttname"&gt;&lt;a href="structDropout.html#a3bb7569a99e88c36e508bee45f379fad"&gt;Dropout::forward_gpu&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;void forward_gpu(array4&amp;lt; maxB, C, H, W &amp;gt; &amp;amp;x)&lt;/div&gt;&lt;div class="ttdoc"&gt;a gpu version of baseline code called from the entry function (forward) &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:227&lt;/div&gt;&lt;/div&gt;
<a id='L85' name='L85'></a>&lt;div class="ttc" id="structarray4_html_ab4374d21733665dbda4acaf2aeccb1df"&gt;&lt;div class="ttname"&gt;&lt;a href="structarray4.html#ab4374d21733665dbda4acaf2aeccb1df"&gt;array4::init_uniform&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;void init_uniform(idx_t B, rnd_gen_t &amp;amp;rg, real p, real q)&lt;/div&gt;&lt;div class="ttdoc"&gt;randomly initialize elements of the array uniformly between p and q &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_arrays.h:603&lt;/div&gt;&lt;/div&gt;
<a id='L86' name='L86'></a>&lt;div class="ttc" id="structarray4_html_a202d1a80c9bb76b2fb34e1c2e3146127"&gt;&lt;div class="ttname"&gt;&lt;a href="structarray4.html#a202d1a80c9bb76b2fb34e1c2e3146127"&gt;array4::set_n_rows&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;__device__ __host__ void set_n_rows(idx_t B)&lt;/div&gt;&lt;div class="ttdoc"&gt;set the number of rows (images) &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_arrays.h:574&lt;/div&gt;&lt;/div&gt;
<a id='L87' name='L87'></a>&lt;div class="ttc" id="structarray4_html_acd8ae42dbddd396fb1a88debdd1bf8e7"&gt;&lt;div class="ttname"&gt;&lt;a href="structarray4.html#acd8ae42dbddd396fb1a88debdd1bf8e7"&gt;array4::set_dev&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;void set_dev(array4&amp;lt; maxB, C, H, W &amp;gt; *dev)&lt;/div&gt;&lt;div class="ttdoc"&gt;set the device shadow of this array &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_arrays.h:701&lt;/div&gt;&lt;/div&gt;
<a id='L88' name='L88'></a>&lt;div class="ttc" id="structDropout_html_a3d9589e177c7fd00af8d7e82db651e48"&gt;&lt;div class="ttname"&gt;&lt;a href="structDropout.html#a3d9589e177c7fd00af8d7e82db651e48"&gt;Dropout::opt&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;cmdline_opt opt&lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:64&lt;/div&gt;&lt;/div&gt;
<a id='L89' name='L89'></a>&lt;div class="ttc" id="structarray4_html_a98fbca33be98702d92368dba1386a879"&gt;&lt;div class="ttname"&gt;&lt;a href="structarray4.html#a98fbca33be98702d92368dba1386a879"&gt;array4::to_dev&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;void to_dev()&lt;/div&gt;&lt;div class="ttdoc"&gt;send the data to its gpu shadow &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_arrays.h:736&lt;/div&gt;&lt;/div&gt;
<a id='L90' name='L90'></a>&lt;div class="ttc" id="structDropout_html_a34adb045be5a2a9546ff99fec3ba1f30"&gt;&lt;div class="ttname"&gt;&lt;a href="structDropout.html#a34adb045be5a2a9546ff99fec3ba1f30"&gt;Dropout::del_dev&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;void del_dev()&lt;/div&gt;&lt;div class="ttdoc"&gt;if the algorithm is a gpu algorithm, dev field must not be null and deallocate it. &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:134&lt;/div&gt;&lt;/div&gt;
<a id='L91' name='L91'></a>&lt;div class="ttc" id="structDropout_html_a5bbc54ad4125bf6768b5eeb17802a468"&gt;&lt;div class="ttname"&gt;&lt;a href="structDropout.html#a5bbc54ad4125bf6768b5eeb17802a468"&gt;Dropout::backward_dev&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;__device__ void backward_dev(array4&amp;lt; maxB, C, H, W &amp;gt; &amp;amp;gy)&lt;/div&gt;&lt;div class="ttdoc"&gt;the device function of backward called from the global (non-member) function &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:316&lt;/div&gt;&lt;/div&gt;
<a id='L92' name='L92'></a>&lt;div class="ttc" id="vgg__util_8h_html_a5451ba9b35b36fff317b514218f7fcb8"&gt;&lt;div class="ttname"&gt;&lt;a href="vgg__util_8h.html#a5451ba9b35b36fff317b514218f7fcb8"&gt;err_gpu_algo_no_gpu&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;#define err_gpu_algo_no_gpu(algo_s)&lt;/div&gt;&lt;div class="ttdoc"&gt;signal a fatal error when a gpu algorithm gets called for cpu only compilation &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_util.h:71&lt;/div&gt;&lt;/div&gt;
<a id='L93' name='L93'></a>&lt;div class="ttc" id="cuda__util_8h_html_afefb7dee05552efd8d1e91a09c90dc79"&gt;&lt;div class="ttname"&gt;&lt;a href="cuda__util_8h.html#afefb7dee05552efd8d1e91a09c90dc79"&gt;dev_malloc&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;static void * dev_malloc(size_t sz)&lt;/div&gt;&lt;div class="ttdoc"&gt;wrap cudaMalloc. cudaMalloc + error check + more ordinary malloc-like interface (return pointer) ...&lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; cuda_util.h:90&lt;/div&gt;&lt;/div&gt;
<a id='L94' name='L94'></a>&lt;div class="ttc" id="structlogger_html_a2d852f1f257849e0abed587814446908"&gt;&lt;div class="ttname"&gt;&lt;a href="structlogger.html#a2d852f1f257849e0abed587814446908"&gt;logger::start_log&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;int start_log(cmdline_opt opt)&lt;/div&gt;&lt;div class="ttdoc"&gt;open a log file and start logging &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_util.h:585&lt;/div&gt;&lt;/div&gt;
<a id='L95' name='L95'></a>&lt;div class="ttc" id="cuda__util_8h_html_ae7d73cb485e300b743d0cb70eaa38f31"&gt;&lt;div class="ttname"&gt;&lt;a href="cuda__util_8h.html#ae7d73cb485e300b743d0cb70eaa38f31"&gt;launch_and_sync&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;#define launch_and_sync(exp)&lt;/div&gt;&lt;div class="ttdoc"&gt;launch a kernel and wait for its completion &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; cuda_util.h:67&lt;/div&gt;&lt;/div&gt;
<a id='L96' name='L96'></a>&lt;div class="ttc" id="structDropout_html_a2adc263cee9f2d84a8d0729ffaf924a6"&gt;&lt;div class="ttname"&gt;&lt;a href="structDropout.html#a2adc263cee9f2d84a8d0729ffaf924a6"&gt;Dropout::forward_cpu&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;void forward_cpu(array4&amp;lt; maxB, C, H, W &amp;gt; &amp;amp;x)&lt;/div&gt;&lt;div class="ttdoc"&gt;a cpu version of baseline code called from the entry function (forward) &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:238&lt;/div&gt;&lt;/div&gt;
<a id='L97' name='L97'></a>&lt;div class="ttc" id="structDropout_html_a55a275be949499a6f3f27fcb9989964e"&gt;&lt;div class="ttname"&gt;&lt;a href="structDropout.html#a55a275be949499a6f3f27fcb9989964e"&gt;Dropout::lgr&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;logger * lgr&lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:65&lt;/div&gt;&lt;/div&gt;
<a id='L98' name='L98'></a>&lt;div class="ttc" id="structDropout_html"&gt;&lt;div class="ttname"&gt;&lt;a href="structDropout.html"&gt;Dropout&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdoc"&gt;dropout layer &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:12&lt;/div&gt;&lt;/div&gt;
<a id='L99' name='L99'></a>&lt;div class="ttc" id="structcmdline__opt_html_a70133aad1b243d44e1be18be81633939"&gt;&lt;div class="ttname"&gt;&lt;a href="structcmdline__opt.html#a70133aad1b243d44e1be18be81633939"&gt;cmdline_opt::weight_seed&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;long weight_seed&lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_util.h:145&lt;/div&gt;&lt;/div&gt;
<a id='L100' name='L100'></a>&lt;div class="ttc" id="structDropout_html_ac409c1b3a996e35eb78964aa52c5a203"&gt;&lt;div class="ttname"&gt;&lt;a href="structDropout.html#ac409c1b3a996e35eb78964aa52c5a203"&gt;Dropout::state_forward&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;long state_forward&lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:70&lt;/div&gt;&lt;/div&gt;
<a id='L101' name='L101'></a>&lt;div class="ttc" id="structDropout_html_afbc57376fb281fd9ab79851c9a9af0fa"&gt;&lt;div class="ttname"&gt;&lt;a href="structDropout.html#afbc57376fb281fd9ab79851c9a9af0fa"&gt;Dropout::to_dev&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;void to_dev()&lt;/div&gt;&lt;div class="ttdoc"&gt;if the algorithm is a gpu algorithm, dev field must not be null and send the host data to the device ...&lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:147&lt;/div&gt;&lt;/div&gt;
<a id='L102' name='L102'></a>&lt;div class="ttc" id="structarray4_html_a53b8b089c3186e3bd2dc51f8a6c1533d"&gt;&lt;div class="ttname"&gt;&lt;a href="structarray4.html#a53b8b089c3186e3bd2dc51f8a6c1533d"&gt;array4::del_dev&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;void del_dev()&lt;/div&gt;&lt;div class="ttdoc"&gt;deallocate the device shadow of this array &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_arrays.h:725&lt;/div&gt;&lt;/div&gt;
<a id='L103' name='L103'></a>&lt;div class="ttc" id="structDropout_html_a69ab2243eeca5c39bf88540aed92fcdc"&gt;&lt;div class="ttname"&gt;&lt;a href="structDropout.html#a69ab2243eeca5c39bf88540aed92fcdc"&gt;Dropout::to_host&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;void to_host()&lt;/div&gt;&lt;div class="ttdoc"&gt;if the algorithm is a gpu algorithm, dev field must not be null and send the device data to the host ...&lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:159&lt;/div&gt;&lt;/div&gt;
<a id='L104' name='L104'></a>&lt;div class="ttc" id="structlogger_html"&gt;&lt;div class="ttname"&gt;&lt;a href="structlogger.html"&gt;logger&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdoc"&gt;logging object &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_util.h:535&lt;/div&gt;&lt;/div&gt;
<a id='L105' name='L105'></a>&lt;div class="ttc" id="structarray4_html_a4d32a5c08163fc8ad6fcc6c4ffb1cfe4"&gt;&lt;div class="ttname"&gt;&lt;a href="structarray4.html#a4d32a5c08163fc8ad6fcc6c4ffb1cfe4"&gt;array4::to_host&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;void to_host()&lt;/div&gt;&lt;div class="ttdoc"&gt;get the data back from gpu shadow to host &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_arrays.h:746&lt;/div&gt;&lt;/div&gt;
<a id='L106' name='L106'></a>&lt;div class="ttc" id="vgg__util_8h_html_a1082d08aaa761215ec83e7149f27ad16"&gt;&lt;div class="ttname"&gt;&lt;a href="vgg__util_8h.html#a1082d08aaa761215ec83e7149f27ad16"&gt;real&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;real_type real&lt;/div&gt;&lt;div class="ttdoc"&gt;type of array elements (may be changed by -Dreal_type=...) &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_util.h:49&lt;/div&gt;&lt;/div&gt;
<a id='L107' name='L107'></a>&lt;div class="ttc" id="structDropout_html_ad1ea86b3d3240a95c9b8c52756ef23a9"&gt;&lt;div class="ttname"&gt;&lt;a href="structDropout.html#ad1ea86b3d3240a95c9b8c52756ef23a9"&gt;Dropout::make_dev&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;void make_dev()&lt;/div&gt;&lt;div class="ttdoc"&gt;if the algorithm is a gpu algorithm, allocate a device shadow of this object and set dev field of thi...&lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:118&lt;/div&gt;&lt;/div&gt;
<a id='L108' name='L108'></a>&lt;div class="ttc" id="structDropout_html_a4181a1bcb986c62b1c6a82a3c1e03d9f"&gt;&lt;div class="ttname"&gt;&lt;a href="structDropout.html#a4181a1bcb986c62b1c6a82a3c1e03d9f"&gt;Dropout::drop_ratio&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;real drop_ratio&lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:69&lt;/div&gt;&lt;/div&gt;
<a id='L109' name='L109'></a>&lt;div class="ttc" id="structarray4_html_aec956ca804fd9176479805bd753b4b1a"&gt;&lt;div class="ttname"&gt;&lt;a href="structarray4.html#aec956ca804fd9176479805bd753b4b1a"&gt;array4::update&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;__device__ __host__ void update(real eta, array4&amp;lt; maxB, C, H, W &amp;gt; &amp;amp;da)&lt;/div&gt;&lt;div class="ttdoc"&gt;update the array by eta and da &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_arrays.h:659&lt;/div&gt;&lt;/div&gt;
<a id='L110' name='L110'></a>&lt;div class="ttc" id="structrnd__gen__t_html"&gt;&lt;div class="ttname"&gt;&lt;a href="structrnd__gen__t.html"&gt;rnd_gen_t&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdoc"&gt;pseudo random number generator crafted from man erand48 + libc source &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_util.h:415&lt;/div&gt;&lt;/div&gt;
<a id='L111' name='L111'></a>&lt;div class="ttc" id="vgg__util_8h_html"&gt;&lt;div class="ttname"&gt;&lt;a href="vgg__util_8h.html"&gt;vgg_util.h&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdoc"&gt;VGG utility functions/classes. &lt;/div&gt;&lt;/div&gt;
<a id='L112' name='L112'></a>&lt;div class="ttc" id="structDropout_html_a364b0df75c98d5b73fd11a77bf11bf89"&gt;&lt;div class="ttname"&gt;&lt;a href="structDropout.html#a364b0df75c98d5b73fd11a77bf11bf89"&gt;Dropout::copy&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;Dropout&amp;lt; maxB, C, H, W &amp;gt; * copy()&lt;/div&gt;&lt;div class="ttdoc"&gt;make a copy of this &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:90&lt;/div&gt;&lt;/div&gt;
<a id='L113' name='L113'></a>&lt;div class="ttc" id="structrnd__gen__t_html_abcddd9ef63e9228770b4e6a77f1aaaa8"&gt;&lt;div class="ttname"&gt;&lt;a href="structrnd__gen__t.html#abcddd9ef63e9228770b4e6a77f1aaaa8"&gt;rnd_gen_t::rand01&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;__device__ __host__ double rand01()&lt;/div&gt;&lt;div class="ttdoc"&gt;return a random number between 0 and 1 &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_util.h:431&lt;/div&gt;&lt;/div&gt;
<a id='L114' name='L114'></a>&lt;div class="ttc" id="cuda__util_8h_html_ade14b7c582717d436e547ed0fcf8e4fe"&gt;&lt;div class="ttname"&gt;&lt;a href="cuda__util_8h.html#ade14b7c582717d436e547ed0fcf8e4fe"&gt;dev_free&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;static void dev_free(void *a)&lt;/div&gt;&lt;div class="ttdoc"&gt;wrap cudaFree &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; cuda_util.h:103&lt;/div&gt;&lt;/div&gt;
<a id='L115' name='L115'></a>&lt;div class="ttc" id="structarray4_html"&gt;&lt;div class="ttname"&gt;&lt;a href="structarray4.html"&gt;array4&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdoc"&gt;4D array &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_arrays.h:548&lt;/div&gt;&lt;/div&gt;
<a id='L116' name='L116'></a>&lt;div class="ttc" id="structDropout_html_a2ce2e6920dfb911f679af91ff9b6de55"&gt;&lt;div class="ttname"&gt;&lt;a href="structDropout.html#a2ce2e6920dfb911f679af91ff9b6de55"&gt;Dropout::dev&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;Dropout&amp;lt; maxB, C, H, W &amp;gt; * dev&lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:62&lt;/div&gt;&lt;/div&gt;
<a id='L117' name='L117'></a>&lt;div class="ttc" id="structDropout_html_a81ee0268c4195380873af8ced5b1acc7"&gt;&lt;div class="ttname"&gt;&lt;a href="structDropout.html#a81ee0268c4195380873af8ced5b1acc7"&gt;Dropout::forward_dev&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;__device__ void forward_dev(array4&amp;lt; maxB, C, H, W &amp;gt; &amp;amp;x)&lt;/div&gt;&lt;div class="ttdoc"&gt;the device function of forward called from the global (non-member) function &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:215&lt;/div&gt;&lt;/div&gt;
<a id='L118' name='L118'></a>&lt;div class="ttc" id="structlogger_html_ae79e87e0de219c9e001417f5b220c325"&gt;&lt;div class="ttname"&gt;&lt;a href="structlogger.html#ae79e87e0de219c9e001417f5b220c325"&gt;logger::end_log&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;int end_log()&lt;/div&gt;&lt;div class="ttdoc"&gt;end logging and close the log file &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_util.h:599&lt;/div&gt;&lt;/div&gt;
<a id='L119' name='L119'></a>&lt;div class="ttc" id="structcmdline__opt_html_a8618cfd6b437743f58258b580d59b466"&gt;&lt;div class="ttname"&gt;&lt;a href="structcmdline__opt.html#a8618cfd6b437743f58258b580d59b466"&gt;cmdline_opt::dropout_seed&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;long dropout_seed&lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_util.h:146&lt;/div&gt;&lt;/div&gt;
<a id='L120' name='L120'></a>&lt;div class="ttc" id="structDropout_html_afe1afe7ce80e59d1b48c820a724aae1b"&gt;&lt;div class="ttname"&gt;&lt;a href="structDropout.html#afe1afe7ce80e59d1b48c820a724aae1b"&gt;Dropout::backward&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;array4&amp;lt; maxB, C, H, W &amp;gt; &amp;amp; backward(array4&amp;lt; maxB, C, H, W &amp;gt; &amp;amp;gy)&lt;/div&gt;&lt;div class="ttdoc"&gt;calc the gradient of loss wrt the input (x) &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:353&lt;/div&gt;&lt;/div&gt;
<a id='L121' name='L121'></a>&lt;div class="ttc" id="structDropout_html_a8d7db70a48a4c2e3887c931b099f1160"&gt;&lt;div class="ttname"&gt;&lt;a href="structDropout.html#a8d7db70a48a4c2e3887c931b099f1160"&gt;Dropout::forward_base&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;__device__ __host__ void forward_base(array4&amp;lt; maxB, C, H, W &amp;gt; &amp;amp;x)&lt;/div&gt;&lt;div class="ttdoc"&gt;the baseline (serial) implementation of forward called both by cpu implementation (forward_cpu) and g...&lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:182&lt;/div&gt;&lt;/div&gt;
<a id='L122' name='L122'></a>&lt;div class="ttc" id="structrnd__gen__t_html_a0e43f9b2d156cb2535bfa1a88cd9eb25"&gt;&lt;div class="ttname"&gt;&lt;a href="structrnd__gen__t.html#a0e43f9b2d156cb2535bfa1a88cd9eb25"&gt;rnd_gen_t::seed&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;__device__ __host__ void seed(uint64_t y)&lt;/div&gt;&lt;div class="ttdoc"&gt;set state of the generator &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_util.h:493&lt;/div&gt;&lt;/div&gt;
<a id='L123' name='L123'></a>&lt;div class="ttc" id="structarray4_html_a68aee457ea4034e17475b6ec5c497c12"&gt;&lt;div class="ttname"&gt;&lt;a href="structarray4.html#a68aee457ea4034e17475b6ec5c497c12"&gt;array4::B&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;idx_t B&lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_arrays.h:552&lt;/div&gt;&lt;/div&gt;
<a id='L124' name='L124'></a>&lt;div class="ttc" id="structarray4_html_a19e463f2ae72c48b92ac558f06366a17"&gt;&lt;div class="ttname"&gt;&lt;a href="structarray4.html#a19e463f2ae72c48b92ac558f06366a17"&gt;array4::dev&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;array4&amp;lt; maxB, C, H, W &amp;gt; * dev&lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_arrays.h:550&lt;/div&gt;&lt;/div&gt;
<a id='L125' name='L125'></a>&lt;div class="ttc" id="dropout_8h_html_a1eba1ae8b54b7b1ac7da64793993f58a"&gt;&lt;div class="ttname"&gt;&lt;a href="dropout_8h.html#a1eba1ae8b54b7b1ac7da64793993f58a"&gt;backward_global&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;__global__ void backward_global(Dropout&amp;lt; maxB, C, H, W &amp;gt; *dev, array4&amp;lt; maxB, C, H, W &amp;gt; *gy_dev)&lt;/div&gt;&lt;div class="ttdoc"&gt;a global CUDA function that implements the baseline backward function for GPU &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:37&lt;/div&gt;&lt;/div&gt;
<a id='L126' name='L126'></a>&lt;div class="ttc" id="vgg__util_8h_html_a8e93478a00e685bea5e6a3f617bf03a3"&gt;&lt;div class="ttname"&gt;&lt;a href="vgg__util_8h.html#a8e93478a00e685bea5e6a3f617bf03a3"&gt;idx_t&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;int idx_t&lt;/div&gt;&lt;div class="ttdoc"&gt;type of array index (either int or long) &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_util.h:39&lt;/div&gt;&lt;/div&gt;
<a id='L127' name='L127'></a>&lt;div class="ttc" id="structcmdline__opt_html_a430664c4a225528c56f959765371755d"&gt;&lt;div class="ttname"&gt;&lt;a href="structcmdline__opt.html#a430664c4a225528c56f959765371755d"&gt;cmdline_opt::iters&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;long iters&lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_util.h:138&lt;/div&gt;&lt;/div&gt;
<a id='L128' name='L128'></a>&lt;div class="ttc" id="structDropout_html_a1cf5aced88d251c6b49772ad318bbd27"&gt;&lt;div class="ttname"&gt;&lt;a href="structDropout.html#a1cf5aced88d251c6b49772ad318bbd27"&gt;Dropout::gx&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;array4&amp;lt; maxB, C, H, W &amp;gt; gx&lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:68&lt;/div&gt;&lt;/div&gt;
<a id='L129' name='L129'></a>&lt;div class="ttc" id="structcmdline__opt_html_a417b11f5b6a5213e293ce930a471a786"&gt;&lt;div class="ttname"&gt;&lt;a href="structcmdline__opt.html#a417b11f5b6a5213e293ce930a471a786"&gt;cmdline_opt::batch_sz&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;idx_t batch_sz&lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_util.h:136&lt;/div&gt;&lt;/div&gt;
<a id='L130' name='L130'></a>&lt;div class="ttc" id="dropout_8h_html_a3078a106aefd1416b053dfc6aa2cef8f"&gt;&lt;div class="ttname"&gt;&lt;a href="dropout_8h.html#a3078a106aefd1416b053dfc6aa2cef8f"&gt;dropout_grad_check_rand&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;static real dropout_grad_check_rand(cmdline_opt opt, logger *lgr, rnd_gen_t &amp;amp;rg, idx_t B)&lt;/div&gt;&lt;div class="ttdoc"&gt;check the gradient computation of a dropout layer &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:401&lt;/div&gt;&lt;/div&gt;
<a id='L131' name='L131'></a>&lt;div class="ttc" id="vgg__util_8h_html_ac27fe6f3d72940b92349035afd50ec6f"&gt;&lt;div class="ttname"&gt;&lt;a href="vgg__util_8h.html#ac27fe6f3d72940b92349035afd50ec6f"&gt;log_end_fun&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;#define log_end_fun(lgr, t0, t1)&lt;/div&gt;&lt;div class="ttdoc"&gt;log the end of the current function &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_util.h:712&lt;/div&gt;&lt;/div&gt;
<a id='L132' name='L132'></a>&lt;div class="ttc" id="structcmdline__opt_html"&gt;&lt;div class="ttname"&gt;&lt;a href="structcmdline__opt.html"&gt;cmdline_opt&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdoc"&gt;command line options &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_util.h:133&lt;/div&gt;&lt;/div&gt;
<a id='L133' name='L133'></a>&lt;div class="ttc" id="structDropout_html_a176eb537c9aef161087863244f1e637f"&gt;&lt;div class="ttname"&gt;&lt;a href="structDropout.html#a176eb537c9aef161087863244f1e637f"&gt;Dropout::rg&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;rnd_gen_t rg&lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:66&lt;/div&gt;&lt;/div&gt;
<a id='L134' name='L134'></a>&lt;div class="ttc" id="structarray4_html_a05126cf0d9fec621264e095d587864da"&gt;&lt;div class="ttname"&gt;&lt;a href="structarray4.html#a05126cf0d9fec621264e095d587864da"&gt;array4::make_dev&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;void make_dev(int gpu)&lt;/div&gt;&lt;div class="ttdoc"&gt;allocate and set the device shadow of this array if requested by the parameter &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_arrays.h:711&lt;/div&gt;&lt;/div&gt;
<a id='L135' name='L135'></a>&lt;div class="ttc" id="structrnd__gen__t_html_a45c7eb16a8f87359f70e007a00cf92e4"&gt;&lt;div class="ttname"&gt;&lt;a href="structrnd__gen__t.html#a45c7eb16a8f87359f70e007a00cf92e4"&gt;rnd_gen_t::get_state&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;__device__ __host__ long get_state()&lt;/div&gt;&lt;div class="ttdoc"&gt;return the current state of the generator &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_util.h:486&lt;/div&gt;&lt;/div&gt;
<a id='L136' name='L136'></a>&lt;div class="ttc" id="structDropout_html_aacd2c2da4fb3bd6718b2b43bc26538b9"&gt;&lt;div class="ttname"&gt;&lt;a href="structDropout.html#aacd2c2da4fb3bd6718b2b43bc26538b9"&gt;Dropout::set_dev&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;void set_dev(Dropout&amp;lt; maxB, C, H, W &amp;gt; *dev)&lt;/div&gt;&lt;div class="ttdoc"&gt;set the device pointer for this and all subobjects &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; dropout.h:104&lt;/div&gt;&lt;/div&gt;
<a id='L137' name='L137'></a>&lt;div class="ttc" id="vgg__util_8h_html_acbdb5e7729d72687cf8a7bade538ebd0"&gt;&lt;div class="ttname"&gt;&lt;a href="vgg__util_8h.html#acbdb5e7729d72687cf8a7bade538ebd0"&gt;show_error&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;static real show_error(real gx_gx, real dx_dx, real gx_dx, real gw_gw, real dw_dw, real gw_dw, real L_minus, real L, real L_plus)&lt;/div&gt;&lt;div class="ttdoc"&gt;show various errors &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_util.h:510&lt;/div&gt;&lt;/div&gt;
<a id='L138' name='L138'></a>&lt;div class="ttc" id="vgg__util_8h_html_a77ac450375c73868fcb54ca2ecae1ba2"&gt;&lt;div class="ttname"&gt;&lt;a href="vgg__util_8h.html#a77ac450375c73868fcb54ca2ecae1ba2"&gt;get_tsc&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;static tsc_t get_tsc()&lt;/div&gt;&lt;div class="ttdoc"&gt;get timestamp (currently just wallclock time in nano seconds) &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_util.h:401&lt;/div&gt;&lt;/div&gt;
<a id='L139' name='L139'></a>&lt;div class="ttc" id="structarray4_html_a3827cfcadd9a47c0f199ababeed1565c"&gt;&lt;div class="ttname"&gt;&lt;a href="structarray4.html#a3827cfcadd9a47c0f199ababeed1565c"&gt;array4::dot&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;real dot(array4&amp;lt; maxB, C, H, W &amp;gt; &amp;amp;a_)&lt;/div&gt;&lt;div class="ttdoc"&gt;dot product with another array &lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_arrays.h:676&lt;/div&gt;&lt;/div&gt;
<a id='L140' name='L140'></a>&lt;div class="ttc" id="vgg__arrays_8h_html"&gt;&lt;div class="ttname"&gt;&lt;a href="vgg__arrays_8h.html"&gt;vgg_arrays.h&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdoc"&gt;vectors, matrices, and multi-dimensional arrays &lt;/div&gt;&lt;/div&gt;
<a id='L141' name='L141'></a>&lt;div class="ttc" id="structcmdline__opt_html_acb8b225214983d009415a26f2e45eb65"&gt;&lt;div class="ttname"&gt;&lt;a href="structcmdline__opt.html#acb8b225214983d009415a26f2e45eb65"&gt;cmdline_opt::gpu_algo&lt;/a&gt;&lt;/div&gt;&lt;div class="ttdeci"&gt;int gpu_algo&lt;/div&gt;&lt;div class="ttdef"&gt;&lt;b&gt;Definition:&lt;/b&gt; vgg_util.h:151&lt;/div&gt;&lt;/div&gt;
<a id='L142' name='L142'></a>&lt;/div&gt;&lt;!-- fragment --&gt;&lt;/div&gt;&lt;!-- contents --&gt;
<a id='L143' name='L143'></a>&lt;!-- start footer part --&gt;
<a id='L144' name='L144'></a>&lt;hr class="footer"/&gt;&lt;address class="footer"&gt;&lt;small&gt;
<a id='L145' name='L145'></a>Generated by &amp;#160;&lt;a href="http://www.doxygen.org/index.html"&gt;
<a id='L146' name='L146'></a>&lt;img class="footer" src="doxygen.png" alt="doxygen"/&gt;
<a id='L147' name='L147'></a>&lt;/a&gt; 1.8.13
<a id='L148' name='L148'></a>&lt;/small&gt;&lt;/address&gt;
<a id='L149' name='L149'></a>&lt;/body&gt;
<a id='L150' name='L150'></a>&lt;/html&gt;
</pre>
<hr />
<a id='BOTTOM' name='BOTTOM'></a>
<em class='comment'>/* <img class='icon' src='../icons/n_left.png' alt='[previous]' /><img class='icon' src='../icons/n_right.png' alt='[next]' /><img class='icon' src='../icons/n_first.png' alt='[first]' /><img class='icon' src='../icons/n_last.png' alt='[last]' /><a href='#TOP'><img class='icon' src='../icons/top.png' alt='[top]' /></a><img class='icon' src='../icons/n_bottom.png' alt='[bottom]' /><a href='../mains.html'><img class='icon' src='../icons/index.png' alt='[index]' /></a><a href='../help.html'><img class='icon' src='../icons/help.png' alt='[help]' /></a>&nbsp;<input type='text' readonly onfocus='this.select();' value='+150 doc/html/dropout_8h_source.html'  /> */</em>
</body>
</html>
